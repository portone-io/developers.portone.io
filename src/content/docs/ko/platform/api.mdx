---
title: 파트너정산 API - alpha 버전
description: 파트너정산에 관련된 API 를 확인할 수 있습니다
---

import Details from "~/components/gitbook/Details.astro";

## 서문

안녕하세요. 포트원 PO 김준일입니다.

파트너 정산 Public API의 스펙을 소개합니다.

포트원이 제공하는 관리자 콘솔을 통해 정산 업무를 확인하고자 한다면, **정산** 부분을 참고해주시고, 귀사의 자체 백오피스에 통합하길 원하신다면 전체 API 스펙을 검토해주시기 바랍니다.

또한, 대량 이체 API는 곧 업데이트될 예정입니다.

개발이 완료되기 전에 알파 버전으로 제공드리며, 개발이 완료되면 동일한 문서 url에 업데이트 되며 테스트 해볼 수 있는 페이지를 swagger형식으로 제공해드리겠습니다.

더 궁금한 사항이 있으시거나 추가적인 도움이 필요하시면 언제든지 연락주세요.

---

## 정산

<div class="gap-4 md:grid grid-cols-2">
<div>

`정산` 객체는 특정 파트너에게 정산금액을 등록할때 생성 됩니다.

고객의 주문(order-transfer) 와 주문취소(order-cancel-transfer)로 부터 계약 규칙에 맞게 파생되는 정산금과 수동으로(manual-transfer) 임의의 정산금액을 등록할 수 있습니다. 고객의 주문건에 대해서는 결제/환불 모두 적용할 수 있습니다.

</div>
<div>

**Endpoints**

```text
POST /platform/order-transfers
POST /platform/order-cancel-transfers
POST /platform/manual-transfers
GET /platform/transfers/{id}
```

</div>
</div>

### 정산 객체

<div class="gap-4 md:grid grid-cols-2">
<div>


**Attributes**

**id** string

정산 객체 아이디

---

**partner** dictionary

정산의 대상이 되는 파트너 객체

[partner attribute](#파트너-객체)

**status** enum

정산의 상태값
|Enum Value|Description|
| --- | --- |
| SCHEDULED | 정산 시작일(settlementStartDate)이 현시점 이후일때 예약 상태 |
| IN_PROCESS | 현시점이 정산 시작일 이후 정산일(settlementDate) 이전일때 진행중 상태 |
| IN_PAYOUT| 이체 중. 관리자 콘솔 내에서 대량이체 엑셀 파일을 받은 후 아직 이체완료 상태값 업데이트를 하지 않았을때|
| SETTLED | 현시점이 정산일 이후일때 완료 상태 |
| PAID_OUT | 이체 완료 상태 |

---

**memo** string

정산에 대한 메모. 수동 정산(manual)에만 해당됩니다.

---

**currency** enum

정산건에 대한 통화. 현재는 결제 통화와 동일한 통화만 지원합니다.

---

**settlementDate** Dictionary

정산일. 정산주기에 맞게 파트너에게 이체되어야 하는 시점이다.

<table>
  <tr>
    <td>

      settlementDate.**year** integer required

      정산일의 연도
    </td>

  </tr>
  <tr>
    <td>

      settlementDate.**month** integer required

      정산일의 월
    </td>

  </tr>
  <tr>
    <td>

      settlementDate.**day** integer required

      정산일의 일
    </td>

  </tr>
</table>
---

**payoutId** string

정산 객체가 정산주기에 맞춰서 포함될 이체 객체의 고유 아이디

status 가 IN_PAYOUT 일때부터 생성됩니다성

---

**contract** dictionary

정산에 적용되는 계약 객체

[contract entity](#계약-객체)

---

**payment** dictionary required

주문 정산건에 해당되는 결제 정보. 포트원(Portone) 결제일때 와 외부 결제(External) 일때 요구되는 값이 다릅니다.
해당 값은 one of 로직으로 간주되어 `"payment": {"portOne": { ... } 혹은 "external": { ... }}` 와 같이 전달해야 합니다.

- 포트원 결제일때 ("payment": {"portOne"})
  포트원 결제 연동 서비스 (sdk, api)에 등록되는 가맹점의 merchant_uid (V1) 혹은 payment_id(V2) 값을 건내주셔야 합니다.

<table>
  <tr>
    <td>

      portOne.**id** string required

      merchant_uid(V1) 혹은 payment_id(V2)

      혹여나 주문은 이루어 졌지만 결제가 이루어지지 않은 경우가 있습니다. 대표적인 예로 포인트 및 쿠폰 (할인) 으로 상품을 사는 case 입니다.
      해당 경우에는 포트원 결제는 없어도 가맹점 내에서 해당 주문에 대한 주문 아이디를 전달해주셔야 합니다.

    </td>

  </tr>
</table>

- 외부 결제일때 ("payment": {"external"})

포트원 결제연동 외에 다른 결제연동 서비스를 통해 결제된 주문건일 경우 외부 결제건으로 간주합니다.

그럴경우 해당 결제의 가맹점 주문번호와 결제통화를 필수로 전달해야 하며 optional로 주문이름, 결제 수단과 같은 부수적인 정보를 전달할 수 있습니다.

<table>
  <tr>
    <td>

      external.**id** string required

      외부 결제연동 서비스를 통해 결제된 주문건의 가맹점 주문번호

    </td>

  </tr>
  <tr>
    <td>

      external.**currency** enum required

      외부 결제연동 서비스를 통해 결제된 주문건의 결제통화

      현재는 'KRW', 'JPY', 'USD' 만 지원합니다.

    </td>

  </tr>
  <tr>
    <td>

      external.**orderName** string optional

      외부 결제연동 서비스를 통해 결제된 주문건의 주문이름

    </td>

  </tr>
  <tr>
    <td>

      external.**method** optional enum

      외부 결제연동 서비스를 통해 결제된 주문건의 결제수단
      아래 결제 수단중 하나만 택해서 전달해야 합니다.
      간편 결제수단("easyPay") 를 제외하고 특정 결제수단에 해당된다면 빈 json 값 (```{}```) 을 전달해야 합니다.

      <table>
        <tr>
          <td>

            method.**card** dictionary optional

            신용카드

          </td>
        </tr>
        <tr>
          <td>

            method.**transfer** dictionary optional

            계좌이체

          </td>
        </tr>
        <tr>
          <td>

            method.**virtualAccount** dictionary optional

            가상계좌

          </td>
        </tr>
        <tr>
          <td>

            method.**giftCertificate** dictionary optional

            상품권

          </td>
        </tr>
        <tr>
          <td>

            method.**mobile** dictionary optional

            휴대폰 소액결휴

          </td>
        </tr>
        <tr>
          <td>

            method.**easyPay** dictionary optional

            간편결제
            <table>
              <tr>
                <td>

                    easyPay.**provider** enum required

                    간편결제 브랜드 (i.e. "KAKAOPAY")



                </td>
              </tr>
              <tr>
                <td>

                  easyPay.**method** enum required

                  간편결제 내의 결제 수단 (i.e. "CARD", "TRANSFER")
                </td>
              </tr>
            </table>

          </td>
        </tr>
      </table>

    </td>

  </tr>
  <tr>
    <td>

      payment.**paidAt** optional Date

      외부 결제연동 서비스를 통해 결제된 주문건의 결제완료 시점

    </td>

  </tr>
</table>

---

**orderDetails** dictionary required

주문 정산건에 해당되는 주문 상세 정보. 주문건에 포함된 상품의 정보를 전달해야 합니다.

one of 로직으로써 단순히 주문금액만 전달하고 싶으신 경우에는 `"orderDetails" : {"orderAmount": 금액}` 와 같이 전달하시면 됩니다.
상품 정보 및 상품별 할인 및 추가수수료를 적용하여 전달하고 싶으신 경우에는 `"orderDetails" : {"orderLines": [{...}, {...}]}` 와 같이 전달하시면 됩니다.

**payment.portOne** 일경우 전달하시지 않으셔도 됩니다. 그럴경우 주문금액은 주어진 **payment.portOne.id** 에 해당되는 결제금액 + **discounts.amount** 의 합에 해당되는 할인금액 으로 계산됩니다.

- 주문금액만 전달할 경우 (`"orderDetails": {"orderAmount": 금액}`)

<table>
  <tr>
    <td>
  
        **orderAmount** int optional

            정산건에 해당되는 주문금액. 결제금액 + 할인금액 입니다.

            단일 주문건에 정산해야할 파트너 대상이 여러명일 경우, 혹은 다른 이유로 여러 정산 건을 생성하고 싶을 경우, 해당되는 주문금액을 전달하시면 됩니다.

            전달하지 기본값은 주어진 **payment.portOne.id** 에 해당되는 결제금액 + **discounts.amount** 의 합에 해당되는 할인금액 입니다.

            **payment.external** 일때는 **orderAmount** 혹은 **orderLines** 를 통해서 주문금액을 전달해주셔야 합니다.
    </td>

  </tr>
</table>

- 상품 정보 및 상품별 금액, 수량 할인 및 추가수수료를 적용하여 전달할 경우 (`"orderDetails": {"orderLines": [{...}, {...}]}`)

해당 정보를 전달하면 주문금액은 전체 상품별 금액들의 합으로 계산됩니다.

<table>
  <tr>
    <td>  
      orderLines.**product** dictionary required

      주문정산건에 해당되는 낱개 상품 정보.

      <table>
        <tr>
          <td>

            product.**id** string required

            상품 아이디. 가맹점의 서버에 등록된 상품 아이디를 임의로 보내주시면 됩니다.

          </td>

        </tr>
        <tr>
          <td>

            product.**name** string required

            상품 이름. 가맹점의 서버에 등록된 상품 이름을 임의로 보내주시면 됩니다.

          </td>

        </tr>
        <tr>
          <td>

            product.**amount** int required

            상품 가격. 상품의 낱개 가격입니다.

          </td>

        </tr>
        <tr>
          <td>

            product.**tag** list of string optional

            상품 태그. 내부 구분을 위한 태그입니다.

          </td>

        </tr>
      </table>
    </td>

  </tr>
  <tr>
    <td>
      orderLines.**quantity** int required

      상품 갯수

      </td>
    </tr>
    <tr>
      <td>
        orderLines.**discounts** list of dictionary optional

        해당 상품에 적용될 할인정보 리스트
        <table>
          <tr>
            <td>
              discounts.**amount** int required

              할인 금액. 상품에 적용될 할인 금액으로써 상품의 가격보다 클 수 없습니다.

            </td>
          </tr>
          <tr>
            <td>
              discounts.**discountShareId** string required

              할인 유형 아이디. 포트원에 등록된 할인 유형 아이디를 보내주시면 됩니다. 해당 아이디의 할인분담율이 정산에 적용됩니다.

            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td>
        orderLines.**additionalFeeIds** list of string optional

        해당 상품에 적용될 추가수수료 아이디 리스트. 포트원에 등록된 추가수수료 아이디를 보내주시면 됩니다. 해당 아이디의 추가수수료가 정산에 적용됩니다.
      </td>
    </tr>

 </table>

---

**settlementStartDate** Date

정산 시작일. 정산주기에 맞춰서 정산이 진행되는 시점이다. 정산 주기가 적용되는 시점이다.

---

**amount** dictionary

<table>
  <tr>
    <td>
      
        amount.**settlement** int64
  
        계산된 정산금액. 
        
        기본적으로 `주문금액 - 플랫폼_중계_수수료 - 중계_수수료_부가세 - PG사_수수료 - PG사_수수료_부가세- 할인분담금 - 추가수수료 - 추가수수료_부가세` 로 계산됩니다.

        수식설정을 통해 계산법을 변경하실 수 있습니다. 수식 설정은 관리자 콘솔에서 가능합니다.
    </td>

  </tr>
  <tr>
    <td>
      
        amount.**payment** int64
  
        결제금액. 
    </td>
  </tr>
  <tr>
    <td>
      
        amount.**order** int64
  
        주문금액. 주문금액 = 결제금액 + 할인금액 으로 통상적으로 계산됩니다. 
    </td>
  </tr>
  <tr>
    <td>
      
        amount.**platformFee** int64
  
        계산된 플랫폼 중개 수수료. 기본적으로 contractId 에 해당되는 수수료가 주문금액에 적용됩니다. 수식설정을 통해 계산법을 변경하실 수 있습니다.

    </td>

  </tr>
  <tr>
    <td>
      
        amount.**platformFeeVat** int64
  
        계산된 중개수수료 부가세. 기본적으로 중개 수수료의 10% 의 내림처리입니다. 수식설정을 통해 소수점 처리를 변경하실 수 있습니다.
    </td>
  </tr>
  <tr>
    <td>
      
        amount.**additionalFee** int64
  
        계산된 추가 수수료. 기본적으로 additionalFeeIds 에 해당되는 추가 수수료가 주문금액에 적용됩니다. 수식설정을 통해 계산법을 변경하실 수 있습니다.
    </td>
  </tr>
  <tr>
    <td>
      
        amount.**additionalFeeVat** int64
  
        계산된 추가 수수료 부가세. 기본적으로 추가 수수료의 10% 의 내림처리입니다. 수식설정을 통해 소수점 처리를 변경하실 수 있습니다.
    </td>
  </tr>
  <tr>
    <td>
      
        amount.**discountShare** int64
  
        계산된 파트너 할인 분담 금액. discountShareId 의 분담율이 적용됩니다. 
    </td>
  </tr>
  <tr>
    <td>
      
        amount.**discount** int64
  
        할인금
    </td>
  </tr>
</table>

---

**discounts** list of dictionary

할인 금액과 유형 (discountShares) 객체의 리스트

리스트의 각 객체별 단일 할인에 해당된다.

해당 값들은 전체 주문건에 대해서 적용된다. 상품별 적용이 아니다.

[할인 유형 참고](#할인-유형)

<table>
  <tr>
    <td>

      discounts.**amount** int64

      할인 금액

    </td>

  </tr>
  <tr>
    <td>

      discounts.**discountShare** dictionary

      할인 유형 (discountShare) 객체

      <table>
        <tr>
          <td>

            discountShare.**id** string

            할인 유형 객체 고유 아이디

          </td>
        </tr>
        <tr>
          <td>

            discountShare.**partnerShareRate** int64

            할인 분담율

          </td>
        </tr>
        <tr>
          <td>

            discountShare.**memo** string

            할인유형 객체 가맹점 지정 내부 메모

          </td>
        </tr>
        <tr>
          <td>

            discountShare.**isHidden** boolean

            할인유형 객체 숨김 여부

          </td>
        </tr>
        <tr>
          <td>

            discountShare.**appliedAt** Date

            할인유형 객체 적용 시간

          </td>
        </tr>
      </table>
    </td>

  </tr>
</table>

---

**additionalFees** list of dictionary

추가수수료 (additionalFee) 객체의 리스트

해당 값들은 전체 주문건에 대해서 적용된다. 상품별 적용이 아니다.

[추가 수수료 참고](#추가-수수료)

- additionalFee attributes

<table>
  <tr>
    <td>

    additionalFee.**id** string

    추가수수료 객체 고유 아이디
    </td>

  </tr>

  <tr>
    <td>

      additionalFee.**fee** dictionary

      추가수수료 객체의 수수료 정보 로써 Fee attributes 이다. Fee attributes 은 정률,정액으로 나뉜다.

      fee attribute

      <table>
        <tr>
          <td>

            fee.**type** enum

            정액(fixed_amount) / 정률(fixedRate)

          </td>
        </tr>
        <tr>
          <td>

            fee.**amount** int64

            정액(fixed_amount) 일경우

          </td>
        </tr>
        <tr>
          <td>

            fee.**rate** int64

            정률(fixedRate)일 경우

          </td>
        </tr>
      </table>
    </td>

  </tr>
  <tr>
    <td>

      additionalFee.**memo** string

      추가수수료 객체 가맹점 지정 내부 메모

    </td>

  </tr>
</table>

---

</div>
<div>

**Response (주문 정산 기준)**

```json
{
  "transfer": {
    "type": "string",
    "graphqlId": "string",
    "id": "string",
    "partner": {
      "graphqlId": "string",
      "id": "string",
      "name": "string",
      "email": "string",
      "businessRegistrationNumber": "string",
      "account": {
        "bank": "BNP",
        "currency": "AED",
        "number": "string",
        "holder": "string",
        "status": "EXPIRED"
      },
      "status": "APPROVED",
      "defaultContractId": "string",
      "memo": "string",
      "tags": ["string"],
      "isHidden": true,
      "appliedAt": "2023-07-25T14:05:50.702Z"
    },
    "status": "IN_PAYOUT",
    "memo": "string",
    "settlementDate": "string",
    "payoutId": "string",
    "currency": "AED",
    "isForTest": true,
    "amount": {
      "settlement": 0,
      "payment": 0,
      "order": 0,
      "platformFee": 0,
      "platformFeeVat": 0,
      "additionalFee": 0,
      "additionalFeeVat": 0,
      "discountShare": 0,
      "discount": 0
    },
    "contract": {
      "graphqlId": "string",
      "id": "string",
      "memo": "string",
      "platformFee": {
        "amount": 0
      },
      "settlementCycle": {
        "lagDays": 0,
        "datePolicy": "CALENDAR_DAY",
        "method": {}
      },
      "vatPayer": "MERCHANT",
      "isHidden": true,
      "appliedAt": "2023-07-25T14:05:50.702Z"
    },
    "payment": {
      "id": "string",
      "orderName": "string",
      "currency": "AED",
      "method": {},
      "paidAt": "2023-07-25T14:05:50.702Z"
    },
    "settlementStartDate": "string",
    "orderLines": [
      {
        "product": {
          "id": "string",
          "name": "string",
          "amount": 0,
          "tag": "string"
        },
        "quantity": 0,
        "discounts": [
          {
            "discountShare": {
              "graphqlId": "string",
              "id": "string",
              "partnerShareRate": 0,
              "memo": "string",
              "isHidden": true,
              "appliedAt": "2023-07-25T14:05:50.702Z"
            },
            "amount": 0
          }
        ],
        "additionalFees": [
          {
            "graphqlId": "string",
            "id": "string",
            "fee": {
              "amount": 0
            },
            "memo": "string",
            "isHidden": true,
            "appliedAt": "2023-07-25T14:05:50.702Z"
          }
        ],
        "amount": {
          "settlement": 0,
          "payment": 0,
          "order": 0,
          "platformFee": 0,
          "platformFeeVat": 0,
          "additionalFee": 0,
          "additionalFeeVat": 0,
          "discountShare": 0,
          "discount": 0
        }
      }
    ],
    "additionalFees": [
      {
        "graphqlId": "string",
        "id": "string",
        "fee": {
          "amount": 0
        },
        "memo": "string",
        "isHidden": true,
        "appliedAt": "2023-07-25T14:05:50.702Z"
      }
    ],
    "discounts": [
      {
        "discountShare": {
          "graphqlId": "string",
          "id": "string",
          "partnerShareRate": 0,
          "memo": "string",
          "isHidden": true,
          "appliedAt": "2023-07-25T14:05:50.702Z"
        },
        "amount": 0
      }
    ]
  }
}
```

</div>
</div>

---

### 주문 정산건 생성

<div class="gap-4 md:grid grid-cols-2">
<div>

주문 정산건이란 결제를 기반으로 한 주문건에 대해서 각 파트너에게 정산해주기 위한 정산객체를 api로 등록하는 겁니다.

**Parameters**

**partnerId** string required

주문 정산건에 해당되는 파트너 지정

---

**contractId** string optional

주문 정산건에 적용될 계약의 아이디. 기본으로 정산될 파트너의 기본 계약이 적용되지만 **contractId** 를 통해 다른 계약을 지정할 경우 지정된 계약의 정보가 적용된다.

---

**memo** string optional

정산건에 내부 구분을 위한 메모

---

**payment** dictionary required

주문 정산건에 해당되는 결제 정보. 포트원(Portone) 결제일때 와 외부 결제(External) 일때 요구되는 값이 다릅니다.
해당 값은 one of 로직으로 간주되어 `"payment": {"portOne": { ... } 혹은 "external": { ... }}` 와 같이 전달해야 합니다.

- 포트원 결제일때 ("payment": {"portOne"})
  포트원 결제 연동 서비스 (sdk, api)에 등록되는 가맹점의 merchant_uid (V1) 혹은 payment_id(V2) 값을 건내주셔야 합니다.

<table>
  <tr>
    <td>

      portOne.**id** string required

      merchant_uid(V1) 혹은 payment_id(V2)

      혹여나 주문은 이루어 졌지만 결제가 이루어지지 않은 경우가 있습니다. 대표적인 예로 포인트 및 쿠폰 (할인) 으로 상품을 사는 case 입니다.
      해당 경우에는 포트원 결제는 없어도 가맹점 내에서 해당 주문에 대한 주문 아이디를 전달해주셔야 합니다.

    </td>

  </tr>
</table>

- 외부 결제일때 ("payment": {"external"})

포트원 결제연동 외에 다른 결제연동 서비스를 통해 결제된 주문건일 경우 외부 결제건으로 간주합니다.

그럴경우 해당 결제의 가맹점 주문번호와 결제통화를 필수로 전달해야 하며 optional로 주문이름, 결제 수단과 같은 부수적인 정보를 전달할 수 있습니다.

<table>
  <tr>
    <td>

      external.**id** string required

      외부 결제연동 서비스를 통해 결제된 주문건의 가맹점 주문번호

    </td>

  </tr>
  <tr>
    <td>

      external.**currency** enum required

      외부 결제연동 서비스를 통해 결제된 주문건의 결제통화

      현재는 'KRW', 'JPY', 'USD' 만 지원합니다.

    </td>

  </tr>
  <tr>
    <td>

      external.**orderName** string optional

      외부 결제연동 서비스를 통해 결제된 주문건의 주문이름

    </td>

  </tr>
  <tr>
    <td>

      external.**method** optional enum

      외부 결제연동 서비스를 통해 결제된 주문건의 결제수단
      아래 결제 수단중 하나만 택해서 전달해야 합니다.
      간편 결제수단("easyPay") 를 제외하고 특정 결제수단에 해당된다면 빈 json 값 (```{}```) 을 전달해야 합니다.

      <table>
        <tr>
          <td>

            method.**card** dictionary optional

            신용카드

          </td>
        </tr>
        <tr>
          <td>

            method.**transfer** dictionary optional

            계좌이체

          </td>
        </tr>
        <tr>
          <td>

            method.**virtualAccount** dictionary optional

            가상계좌

          </td>
        </tr>
        <tr>
          <td>

            method.**giftCertificate** dictionary optional

            상품권

          </td>
        </tr>
        <tr>
          <td>

            method.**mobile** dictionary optional

            휴대폰 소액결휴

          </td>
        </tr>
        <tr>
          <td>

            method.**easyPay** dictionary optional

            간편결제
            <table>
              <tr>
                <td>

                    easyPay.**provider** enum required

                    간편결제 브랜드 (i.e. "KAKAOPAY")



                </td>
              </tr>
              <tr>
                <td>

                  easyPay.**method** enum required

                  간편결제 내의 결제 수단 (i.e. "CARD", "TRANSFER")
                </td>
              </tr>
            </table>

          </td>
        </tr>
      </table>

    </td>

  </tr>
  <tr>
    <td>

      payment.**paidAt** optional Date

      외부 결제연동 서비스를 통해 결제된 주문건의 결제완료 시점

    </td>

  </tr>
</table>

---

**orderDetails** dictionary required

주문 정산건에 해당되는 주문 상세 정보. 주문건에 포함된 상품의 정보를 전달해야 합니다.

one of 로직으로써 단순히 주문금액만 전달하고 싶으신 경우에는 `"orderDetails" : {"orderAmount": 금액}` 와 같이 전달하시면 됩니다.
상품 정보 및 상품별 할인 및 추가수수료를 적용하여 전달하고 싶으신 경우에는 `"orderDetails" : {"orderLines": [{...}, {...}]}` 와 같이 전달하시면 됩니다.

**payment.portOne** 일경우 전달하시지 않으셔도 됩니다. 그럴경우 주문금액은 주어진 **payment.portOne.id** 에 해당되는 결제금액 + **discounts.amount** 의 합에 해당되는 할인금액 으로 계산됩니다.

- 주문금액만 전달할 경우 (`"orderDetails": {"orderAmount": 금액}`)

<table>
  <tr>
    <td>
  
        **orderAmount** int optional

            정산건에 해당되는 주문금액. 결제금액 + 할인금액 입니다.

            단일 주문건에 정산해야할 파트너 대상이 여러명일 경우, 혹은 다른 이유로 여러 정산 건을 생성하고 싶을 경우, 해당되는 주문금액을 전달하시면 됩니다.

            전달하지 기본값은 주어진 **payment.portOne.id** 에 해당되는 결제금액 + **discounts.amount** 의 합에 해당되는 할인금액 입니다.

            **payment.external** 일때는 **orderAmount** 혹은 **orderLines** 를 통해서 주문금액을 전달해주셔야 합니다.
    </td>

  </tr>
</table>

- 상품 정보 및 상품별 금액, 수량 할인 및 추가수수료를 적용하여 전달할 경우 (`"orderDetails": {"orderLines": [{...}, {...}]}`)

해당 정보를 전달하면 주문금액은 전체 상품별 금액들의 합으로 계산됩니다.

<table>
  <tr>
    <td>  
      orderLines.**product** dictionary required

      주문정산건에 해당되는 낱개 상품 정보.

      <table>
        <tr>
          <td>

            product.**id** string required

            상품 아이디. 가맹점의 서버에 등록된 상품 아이디를 임의로 보내주시면 됩니다.

          </td>

        </tr>
        <tr>
          <td>

            product.**name** string required

            상품 이름. 가맹점의 서버에 등록된 상품 이름을 임의로 보내주시면 됩니다.

          </td>

        </tr>
        <tr>
          <td>

            product.**amount** int required

            상품 가격. 상품의 낱개 가격입니다.

          </td>

        </tr>
        <tr>
          <td>

            product.**tag** list of string optional

            상품 태그. 내부 구분을 위한 태그입니다.

          </td>

        </tr>
      </table>
    </td>

  </tr>
  <tr>
    <td>
      orderLines.**quantity** int required

      상품 갯수

      </td>
    </tr>
    <tr>
      <td>
        orderLines.**discounts** list of dictionary optional

        해당 상품에 적용될 할인정보 리스트
        <table>
          <tr>
            <td>
              discounts.**amount** int required

              할인 금액. 상품에 적용될 할인 금액으로써 상품의 가격보다 클 수 없습니다.

            </td>
          </tr>
          <tr>
            <td>
              discounts.**discountShareId** string required

              할인 유형 아이디. 포트원에 등록된 할인 유형 아이디를 보내주시면 됩니다. 해당 아이디의 할인분담율이 정산에 적용됩니다.

            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td>
        orderLines.**additionalFeeIds** list of string optional

        해당 상품에 적용될 추가수수료 아이디 리스트. 포트원에 등록된 추가수수료 아이디를 보내주시면 됩니다. 해당 아이디의 추가수수료가 정산에 적용됩니다.
      </td>
    </tr>

</table>

---

**settlementStartDate** dictionary 기본값은 결제완료 시점

정산 시작일로써 정산 주기가 적용될 날짜이다. 주문완료, 배송완료 등 정산이 고려되기 시작해야하는 시간을 뜻한다. 기본값은 주문정산건과 연결된 결제의 완료 시점으로 업데이트 된다.

따라서 **payment.portOne** 일때는 포트원 결제완료 시점, **payment.external** 일때는 **payment.paidAt** 값이 기본값으로 적용되며 **payment.paidAt** 값을 전달하지 않을경우 현재시점으로 적용된다.

배송완료 예정일, 수강 오픈일, 등 미래시점으로 지정해 놓으면 해당 시점부터 정산주기가 적용되며 그동안 정산객체의 상태값은 준비 (**PREPARE**)로 적용된다.

<table>
  <tr>
    <td>

      settlementStartDate.**year** integer required

      정산 시작일의 연도
    </td>

  </tr>
  <tr>
    <td>

      settlementStartDate.**month** integer required

      정산 시작일의 월
    </td>

  </tr>
  <tr>
    <td>

      settlementStartDate.**day** integer required

      정산 시작일의 일
    </td>

  </tr>
</table>

---

**discounts** optional

주문 정산건에 적용할 할인 유형들의 리스트. 할인 유형 객체들로 이루어져 있다.

할인 유형이란 특정 주문에 적용된 할인에 대해서 유형별 파트너 분담율을 정산에 계산하기 위한 객체이다.

**orderLines**를 통해 각 상품별 적용될 할인 정보와 **orderLines.discounts** 별개로 해당 파라미터는 주문건 전체에 적용될 할인 정보를 전달할 때 사용합니다.

<table>
  <tr>
    <td>

      discount.*discountShareId** string required

      할인 유형 아이디. 포트원에 등록된 할인 유형 아이디를 보내주시면 됩니다. 해당 아이디의 할인분담율이 정산에 적용됩니다.

    </td>

  </tr>
  <tr>
    <td>

      discount.**amount** int64 required

      할인 금액. 주문금액보다 클 수 없습니다.



    </td>

  </tr>

</table>

---

**additionalFeesIds** string optional

주문 정산건에 적용될 추가 수수료 아이디들의 리스트

추가수수료란 특정 주문정산건에 가맹점이 파트너에게 추가 서비스를 제공함으로써 과금되는 수수료 이다. 정산수식에대한 수정이 있지 않는한 기본으로 추가수수료는 주문금액에 부과된다.

---

**isForTest** boolean optional 기본값은 false

포트원의 테스트 서버로 정산 데이터를 전달할지 여부를 결정한다. 기본값은 false이다. 테스트 서버로 전달할 경우 정산 데이터는 테스트 서버에만 저장되며 실제 정산에는 반영되지 않는다.

---

</div>
<div>
**Request body**
```json
{
  "partnerId": "string",
  "contractId": "string",
  "memo": "string",
  "payment": {
    "portOne": {
      "id": "string"
    },
    "external": {
      "id": "string",
      "currency": "AED",
      "orderName": "string",
      "paidAt": "2023-07-23T06:27:26.804Z",
      "method": {
        "card": {},
        "transfer": {},
        "virtualAccount": {},
        "giftCertificate": {},
        "mobile": {},
        "easyPay": {
          "provider": "KAKAOPAY",
          "method": "CARD"
        }
      }
    }
  },
  "orderDetail": {
    "orderAmount": 0,
    "orderLines": [
      {
        "product": {
          "id": "string",
          "name": "string",
          "amount": 0,
          "tag": "string"
        },
        "quantity": 0,
        "discounts": [
          {
            "discountShareId": "string",
            "amount": 0
          }
        ],
        "additionalFeeIds": [
          "string"
        ]
      }
    ]
  },
  "settlementStartDate": {
    "year": 0,
    "month": 0,
    "day": 0
  },
  "discounts": [
    {
      "discountShareId": "string",
      "amount": 0
    }
  ],
  "additionalFeeIds": [
    "string"
  ],
  "isForTest": true
}
```

**Request Examples**

- 포트원 결제일 경우

```text
curl -X POST https://api.portone.com/v2/platform/transfer/order \
     -u {api_key} \
     -d 'partnerId=lecturer_1' \
     -d 'payment[portOne[paymentId]]=merchant_uid1' \
     -d 'discounts=[{"amount":1000, "discountShareId": "discount_1"}]'
```

- 포트원 결제일 경우
- 상품 정보를 전달할 경우

```text
curl -X POST https://api.portone.com/v2/platform/transfer/order \
     -u {api_key} \
     -d 'partnerId=lecturer_1' \
     -d 'payment[portOne[paymentId]]=merchant_uid1' \
     -d 'orderDetail[orderLines]=[{"product":{"name":"product1", "amount":10000, "tag": "tag1"}, "quantity": 1, "discounts": [{"amount":1000, "discountShareId": "discount_1"}], "additionalFeeIds": ["additionalFee_1"]}]'
```

- 외부 결제일 경우 (**payment[source]** = **EXTERNAL**)

```text
curl -X POST https://api.portone.com/v2/platform/transfer/order \
     -u {api_key} \
     -d 'partnerId=lecturer_1' \
     -d 'payment[external] = {"payment_id" : "merchant_uid", "currency": "KRW"} \
     -d 'orderAmount = 10000' \
     -d 'discounts=[{"amount":1000, "discountShareId": "discount_1"}]'
```

- 외부 결제일 경우
- 상품 정보를 전달할 경우

```text
curl -X POST https://api.portone.com/v2/platform/transfer/order \
     -u {api_key} \
     -d 'partnerId=lecturer_1' \
     -d 'payment[external] = {"payment_id" : "merchant_uid", "currency": "KRW"} \
     -d 'orderDetail[orderLines]=[{"product":{"name":"product1", "amount":10000, "tag": "tag1"}, "quantity": 1, "discounts": [{"amount":1000, "discountShareId": "discount_1"}], "additionalFeeIds": ["additionalFee_1"]}]'
```

**Response**

주문 정산객체가 반환됩니다.

**정산 시작일 참고**

- 정산시작일(settlementStartDate)을 전달하지 않을경우 결제완료 시점으로 기본으로 지정됩니다. 이 경우 정산 api호출시점에 결제완료가 아직 되지 않았다면 에러를 반환합니다.
- 정산시작일(settlementStartDate)을 미래의 시점으로 전달할 경우 status 는 PREPARE이고 이에 적용될 계약정보는 정산api를 호출한 시점에 등록된 계약으로 적용되나 계약정보가 바뀌어 업데이트 될 여지가 있습니다.

---

- 포트원 결제일 경우
- 상품 정보를 전달할 경우

```json
{
  "transfer": {
    "type": "ORDER",
    "graphqlId": "string",
    "id": "transferId1",
    "partner": {
      "graphqlId": "string",
      "id": "lecturer_1",
      "name": "파이썬 강사",
      "email": "python@platform.com",
      "businessRegistrationNumber": "",
      "account": {
        "bank": "신한은행",
        "currency": "KRW",
        "number": "110-123-456789",
        "holder": "파이썬 강사",
        "status": "APPROVED"
      },
      "status": "APPROVED",
      "defaultContractId": "lecture_contract_1",
      "memo": "컴싸 강사",
      "tags": ["코딩"],
      "isHidden": false,
      "appliedAt": "2023-07-25T14:05:50.702Z"
    },
    "status": "SETTLED",
    "memo": "string",
    "settlementDate": "2023-07-25T14:05:50.702Z",
    "payoutId": "payout_1", // 이체 ID는 실제 이체완료 상태값 업데이트 후에 생성됩니다
    "currency": "KRW",
    "isForTest": false,
    "amount": {
      "settlement": 785,
      "payment": 900,
      "order": 1000,
      "platformFee": 100,
      "platformFeeVat": 10,
      "additionalFee": 50,
      "additionalFeeVat": 5,
      "discountShare": 50,
      "discount": 100
    },
    "contract": {
      "graphqlId": "string",
      "id": "lecture_contract_1",
      "memo": "파이선강사 계약",
      "platformFee": {
        "rate": 10000000
      },
      "settlementCycle": {
        "lagDays": 2,
        "datePolicy": "CALENDAR_DAY",
        "method": {}
      },
      "vatPayer": "PARTNER",
      "isHidden": false,
      "appliedAt": "2023-07-25T14:05:50.702Z"
    },
    "payment": {
      "id": "paymentId1",
      "currency": "KRW",
      "method": {},
      "paidAt": "2023-07-25T14:05:50.702Z"
    },
    "settlementStartDate": "2023-07-25T14:05:50.702Z",
    "orderLines": [
      {
        "product": {
          "id": "product1",
          "name": "파이썬 하반기 강의",
          "amount": 10000,
          "tag": "코딩"
        },
        "quantity": 1,
        "additionalFees": [
          {
            "graphqlId": "string",
            "id": "string",
            "fee": {
              "amount": 0
            },
            "memo": "string",
            "isHidden": true,
            "appliedAt": "2023-07-25T14:05:50.702Z"
          }
        ],
        "discounts": [
          {
            "discountShare": {
              "graphqlId": "string",
              "id": "string",
              "partnerShareRate": 0,
              "memo": "string",
              "isHidden": true,
              "appliedAt": "2023-07-25T14:05:50.702Z"
            },
            "amount": 0
          }
        ],
        "amount": {
          "settlement": 785,
          "payment": 900,
          "order": 1000,
          "platformFee": 100,
          "platformFeeVat": 10,
          "additionalFee": 50,
          "additionalFeeVat": 5,
          "discountShare": 50,
          "discount": 100
        }
      }
    ],
    "discounts": [
      {
        "discountShare": {
          "graphqlId": "string",
          "id": "discountShareId1",
          "partnerShareRate": 50,
          "memo": "강사 할인 쿠폰",
          "isHidden": false,
          "appliedAt": "2023-07-25T14:05:50.702Z"
        },
        "amount": 100
      }
    ],
    "additionalFees": [
      {
        "graphqlId": "string",
        "id": "additionalFeeId1",
        "fee": {
          "amount": 50
        },
        "memo": "string",
        "isHidden": true,
        "appliedAt": "2023-07-25T14:05:50.702Z"
      }
    ]
  }
}
```

</div>
</div>

---

### 주문 취소 정산건 생성

<div class="grid-cols-2 gap-4 md:grid">
<div>

주문 취소 정산건이란 결제 취소를 기반으로 파트너에게 정산금을 차감할 수 있는 api입니다.

취소 정산 등록은 사전에 주문 정산이 등록되어 있는 경우에만 사용할 수 있습니다.

결제 취소에 대한 id를 전달주셔야 하며 취소시 차감되는 주문금액 및 할인금액 에 따라 차감될 정산금액을 계산합니다.

**Parameters**

**partnerId** required

주문 취소 정산건에 해당되는 파트너 지정

---

**memo** optional

주문 취소 정산 건에 내부 구분을 위한 메모

---

**payment** required

주문 정산건에 해당되는 결제 정보. 포트원(Portone) 결제일때 와 외부 결제(External) 일때 요구되는 값이 다릅니다.
해당 값은 one of 로직으로 간주되어 `"payment": {"portOne": { ... } 혹은 "external": { ... }}` 와 같이 전달해야 합니다.

주문 정산건의 **payment** 에서 추가되는 부분은 결제취소 아이디 (cancellationId)를 전달하는 점입니다.

- 포트원 결제일때 ("payment": {"portOne"})
  포트원 결제 연동 서비스 (sdk, api)에 소록되는 가맹점의 merchant_uid (V1) 혹은 payment_id(V2) 값을 건내주셔야 합니다.

<table>
  <tr>
    <td>

      portOne.**id** required

      merchant_uid(V1) 혹은 payment_id(V2)

      혹여나 주문은 이루어 졌지만 결제가 이루어지지 않은 경우가 있습니다. 대표적인 예로 포인트 및 쿠폰 (할인) 으로 상품을 사는 case 입니다.
      해당 경우에는 포트원 결제는 없어도 가맹점 내에서 해당 주문에 대한 주문 아이디를 전달해주셔야 합니다.

    </td>

  </tr>
  <tr>
    <td>

      portOne.**cancellationId** required

      포트원 결제 취소 아이디. 주문취소 정산시 검증을 위해 결제 취소 아이디를 요구합니다.

      cancellation_id 에 대한 정보는 [v2 결제관련 api](https://developers.portone.io/docs/ko/api-v2/payment) 를 참고해주세요.
      `v2/payments/{'{payment_id}'}` 혹은 `v2/payments` 를 통해 결제내역 조회한뒤 cancellations json 에서 확인하실 수 있습니다.
    </td>

  </tr>
</table>

- 외부 결제일때 ("payment": {"external"})

포트원 결제연동 외에 다른 결제연동 서비스를 통해 결제된 주문건일 경우 외부 결제건으로 간주합니다.

그럴경우 해당 결제의 가맹점 주문번호와 결제통화를 필수로 전달해야 하며 optional로 주문이름, 결제 수단과 같은 부수적인 정보를 전달할 수 있습니다.

<table>
  <tr>
    <td>

      external.**id** required

      외부 결제연동 서비스를 통해 결제된 주문건의 가맹점 주문번호

    </td>

  </tr>
  <tr>
    <td>

    external.**cancellationId** optional

    외부 결제연동 서비스를 통해 결제된 주문건의 결제 취소 아이디. 외부 결제서비스는 검증을 할수 없기에 필수값이 아닙니다.
    </td>

  </tr>
</table>

---

**orderDetails** required

주문취소 정산건에 해당되는 주문 상세 정보. 기존 주문건에 포함된 상품의 정보중 취소하고자 한는 항목을 전달해야 합니다.

one of 로직으로써 단순히 주문취소 금액만 전달하고 싶으신 경우에는 `"orderDetails" : {"orderAmount": 금액}` 와 같이 전달하시면 됩니다.
취소하고자 하는 상품 정보 및 상품별 할인금 을 전달하고 싶으신 경우에는 `"orderDetails" : {"orderLines": [{...}, {...}]}` 와 같이 전달하시면 됩니다.

- 주문취소 금액만 전달할 경우 (`"orderDetails": {"orderAmount": 금액}`)

<table>
  <tr>
    <td>
  
        **orderAmount** optional

            주문 취소시 적용될 주문 취소금액. 주문금액 인점 유의 하셔야 합니다. 주문금액은 결제금액 + 할인금액 입니다.

            해당 값이 주문 정산시 주문금액과 동일한 경우에는 따로 취소하실 할인금액을 전달하지 않으셔도 환불 처리 됩니다.
    </td>

  </tr>
</table>

- 상품 정보 및 상품별 금액, 수량 할인 및 추가수수료를 적용하여 전달할 경우 (`"orderDetails": {"orderLines": [{...}, {...}]}`)

해당 정보를 전달하면 주문금액은 전체 상품별 금액들의 합으로 계산됩니다.

<table>
  <tr>
    <td>  
      orderLines.**productId** dictionary required

      취소하고자 하는 상품 아이디
    </td>

  </tr>
  <tr>
    <td>
      orderLines.**quantity** required

      취소하고자 하는 상품 갯수

      </td>
    </tr>
    <tr>
      <td>
        orderLines.**discounts** list of dictionary optional

        해당 상품에서 취소하고자 하는  할인정보 리스트

        상품에 대한 모든 수량 취소시 모든 discount도 자동으로 취소됩니다.
        <table>
          <tr>
            <td>
              discounts.**amount** required

              취소할 할인 금액. 해당 상품에 적용되었던 할인 금액중 환불에 해당하는 금액을 전달 주시면 됩니다.

            </td>
          </tr>
          <tr>
            <td>
              discounts.**discountShareId** required

              할인 유형 아이디. 주문 정산시 상품에 등록되었던 할인 유형 아이디 중 취소하고자 하는 아이디를 전달주시면 됩니다.

            </td>
          </tr>
        </table>
      </td>
    </tr>

</table>

---

**settlementStartDate** dictionary 기본값은 결제완료 시점

취소 정산 또한 주문 정산과 동일하게 정산주기가 적용됩니다. 따라서 주문 정산건이 이미 정산이 되었고 해당 주문건에 대한 취소정산이 이루어졌을때 취소금액은 다음 정산주기에 적용됩니다.

따라서 **payment.portOne** 일때는 포트원 결제취소 시점 값이 기본값으로 적용됩니다.

<table>
  <tr>
    <td>

      settlementStartDate.**year** integer required

      정산 시작일의 연도
    </td>

  </tr>
  <tr>
    <td>

      settlementStartDate.**month** integer required

      정산 시작일의 월
    </td>

  </tr>
  <tr>
    <td>

      settlementStartDate.**day** integer required

      정산 시작일의 일
    </td>

  </tr>
</table>

---

**discounts** optional

주문 취소시 적용될 할인정보 리스트

모든 금액 취소시 모든 discount도 자동으로 취소됩니다.

<table>
  <tr>
    <td>

      discount.*discountShareId** string required

      할인 유형 아이디. 주문 정산시 등록되었던 할인 유형 아이디 중 취소하고자 하는 아이디를 전달주시면 됩니다.

    </td>

  </tr>
  <tr>
    <td>

      discount.**amount** int64 required

      취소할 할인 금액. 해당 주문에 적용되었던 할인 금액중 환불에 해당하는 금액을 전달 주시면 됩니다.

    </td>

  </tr>

</table>

---

**isForTest** boolean optional 기본값은 false

포트원의 테스트 서버로 정산 데이터를 전달할지 여부를 결정한다. 기본값은 false이다. 테스트 서버로 전달할 경우 정산 데이터는 테스트 서버에만 저장되며 실제 정산에는 반영되지 않는다.

</div>
<div>

취소 정산의 취소 주문금액 , 상품별 취소 주문 금액 및 수량, 주문 취소 할인금액 및 상품별 취소 할인 금액에 따라 새로운 음수 정산금액을 계산하신다고 이해하시면 됩니다.

**Request Body**

```json
{
  "partnerId": "string",
  "memo": "string",
  "payment": {
    "portOne": {
      "id": "string",
      "cancellationId": "string"
    },
    "external": {
      "id": "string",
      "cancellationId": "string"
    }
  },
  "orderDetail": {
    "orderAmount": 0,
    "orderLines": [
      {
        "productId": "string",
        "quantity": 0,
        "discounts": [
          {
            "discountShareId": "string",
            "amount": 0
          }
        ]
      }
    ]
  },
  "discounts": [
    {
      "discountShareId": "string",
      "amount": 0
    }
  ],
  "settlementStartDate": {
    "year": 0,
    "month": 0,
    "day": 0
  },
  "isForTest": false
}
```

**Request**

- PORTONE 결제인 경우 (cancellationId 필수)

```text
curl -X POST https://api.portone.com/v2/platform/order-cancel-transfer \
     -u {api_key} \
     -d 'partnerId=lecturer_1' \
     -d  payment[portOne[paymentId]]=merchant_uid1' \
     -d 'payment[portOne[cancellationId]]=merchant_uid1_cancel1' \
     -d 'orderDetail[orderLines]=[{"productId" : "python_lecture_1", "quantity":1 }]' \
```

**Response**

취소 정산시 반환되는 금액 및 수수 값들은 다 주문정산객체 값의 음수처리 입니다.

```json
{
  "transfer": {
    "type": "ORDER",
    "graphqlId": "string",
    "id": "transferId1",
    "partner": {
      "graphqlId": "string",
      "id": "lecturer_1",
      "name": "파이썬 강사",
      "email": "python@platform.com",
      "businessRegistrationNumber": "",
      "account": {
        "bank": "신한은행",
        "currency": "KRW",
        "number": "110-123-456789",
        "holder": "파이썬 강사",
        "status": "APPROVED"
      },
      "status": "APPROVED",
      "defaultContractId": "lecture_contract_1",
      "memo": "컴싸 강사",
      "tags": ["코딩"],
      "isHidden": false,
      "appliedAt": "2023-07-25T14:05:50.702Z"
    },
    "status": "SETTLED",
    "memo": "string",
    "settlementDate": "2023-07-25T14:05:50.702Z",
    "payoutId": "payout_1", // 이체 ID는 실제 이체완료 상태값 업데이트 후에 생성됩니다
    "currency": "KRW",
    "isForTest": false,
    "amount": {
      "settlement": 785,
      "payment": 900,
      "order": 1000,
      "platformFee": 100,
      "platformFeeVat": 10,
      "additionalFee": 50,
      "additionalFeeVat": 5,
      "discountShare": 50,
      "discount": 100
    },
    "contract": {
      "graphqlId": "string",
      "id": "lecture_contract_1",
      "memo": "파이선강사 계약",
      "platformFee": {
        "rate": 10000000
      },
      "settlementCycle": {
        "lagDays": 2,
        "datePolicy": "CALENDAR_DAY",
        "method": {}
      },
      "vatPayer": "PARTNER",
      "isHidden": false,
      "appliedAt": "2023-07-25T14:05:50.702Z"
    },
    "payment": {
      "id": "paymentId1",
      "currency": "KRW",
      "method": {},
      "paidAt": "2023-07-25T14:05:50.702Z"
    },
    "settlementStartDate": "2023-07-25T14:05:50.702Z",
    "orderLines": [
      {
        "product": {
          "id": "product1",
          "name": "파이썬 하반기 강의",
          "amount": 10000,
          "tag": "코딩"
        },
        "quantity": 1,
        "additionalFees": [
          {
            "graphqlId": "string",
            "id": "string",
            "fee": {
              "amount": 0
            },
            "memo": "string",
            "isHidden": true,
            "appliedAt": "2023-07-25T14:05:50.702Z"
          }
        ],
        "discounts": [
          {
            "discountShare": {
              "graphqlId": "string",
              "id": "string",
              "partnerShareRate": 0,
              "memo": "string",
              "isHidden": true,
              "appliedAt": "2023-07-25T14:05:50.702Z"
            },
            "amount": 0
          }
        ],
        "amount": {
          "settlement": 785,
          "payment": 900,
          "order": 1000,
          "platformFee": 100,
          "platformFeeVat": 10,
          "additionalFee": 50,
          "additionalFeeVat": 5,
          "discountShare": 50,
          "discount": 100
        }
      }
    ],
    "discounts": [
      {
        "discountShare": {
          "graphqlId": "string",
          "id": "discountShareId1",
          "partnerShareRate": 50,
          "memo": "강사 할인 쿠폰",
          "isHidden": false,
          "appliedAt": "2023-07-25T14:05:50.702Z"
        },
        "amount": 100
      }
    ],
    "additionalFees": [
      {
        "graphqlId": "string",
        "id": "additionalFeeId1",
        "fee": {
          "amount": 50
        },
        "memo": "string",
        "isHidden": true,
        "appliedAt": "2023-07-25T14:05:50.702Z"
      }
    ]
    "cancellation": {
      "id": "string",
      "cancelledAt": "2023-07-25T14:36:27.155Z"
    }
  }
}
```

</div>
</div>

### 수동 정산건 생성

<div class="grid-cols-2 gap-4 md:grid">
<div>

수동 정산건이란 결제를 기반으로 하지않고 고객이 원하는 만큼 파트너에게 정산금을 추가 및 차감할 수 있는 api입니다.

**Parameters**

**partnerId** string required

해당 수동 정산건이 적용될 파트너의 고유 아이디

---

**settlementAmount** int required

해당 수동 정산건으로 적용하길 원하는 금액. 음수 및 양수 둘다 가능하다.

---

**settlementDate** dictionary optional 기본값은 파트너의 다가올 정산일

해당 수동 정산건이 적용되길 원하는 정산일. 전달하지 않을경우 해당 파트너의 가장 가까운 미래 정산일이 적용된다.

<table>
  <tr>
    <td>

      settlementDate.**year** integer required

      정산일 연도
    </td>

  </tr>
  <tr>
    <td>

      settlementDate.**month** integer required

      정산 월
    </td>

  </tr>
  <tr>
    <td>

      settlementDate.**day** integer required

      정산일
    </td>

  </tr>
</table>

---

**memo** string optional

해당 수동 정산건 등록시 내부 관리를 위해 전달하는 메모.
50자 까지 가능하다다

---

**isForTest** boolean optional 기본값은 false

포트원의 테스트 서버로 정산 데이터를 전달할지 여부를 결정한다. 기본값은 false이다. 테스트 서버로 전달할 경우 정산 데이터는 테스트 서버에만 저장되며 실제 정산에는 반영되지 않는다.

</div>
<div>
**Request Body**

```json
Example Value
Schema
{
  "partnerId": "string",
  "memo": "string",
  "settlementAmount": 0,
  "settlementDate": {
    "year": 0,
    "month": 0,
    "day": 0
  },
  "isForTest": true
}
```

**Request**

```text
curl -X POST https://api.portone.com/v2/platform/manual-transfers \
     -u {api_key} \
     -d 'partnerId=lecturer_1' \
     -d 'settlementAmount=300000' \
     -d 'settlementDate={"year":2023,"month":7,"day":31}' \
     -d 'memo=이체건 차감'
```

**Response**

수동 정산객체가 반환된다.

```json
{
  "transfer": {
    "id": "transfer_id",
    "partner": {
      "id": "lecturer_1",
      "name": "파이썬 강사",
      "email": "python@platform.com",
      "businessRegistrationNumber": "",
      "account": {
        "bank": "신한은행",
        "currency": "KRW",
        "number": "110-123-456789",
        "holder": "string",
        "status": "APPROVED"
      },
      "status": "APPROVED",
      "defaultContractId": "lecutre_contract_1",
      "memo": "string",
      "tags": ["string"],
      "isHidden": false,
      "appliedAt": "2023-07-24T02:39:29.892Z"
    },
    "status": "IN_PAYOUT",
    "memo": "수동정산",
    "settlementDate": {
      "year": 2023,
      "month": 7,
      "day": 31
    },
    "payoutId": "",
    "currency": "KRW",
    "isForTest": false,
    "settlementAmount": 300000
  }
}
```

</div>
</div>

---

### 정산 조회

<div class="grid-cols-2 gap-4 md:grid">
<div>

등록된 정산객체를 조회합니다.

**Parameters**

Request Body 는 없습니다.

</div>
<div>

**Request**

```text
curl -X GET https://api.portone.com/v2/platform/transfers/{id} \
     -u {api_key}
```

**Response**

정산정보가 반환됩니다.

```json
{
  "id": "transfer_id1",
  "partner": {
    "id": "lecturer_1",
    "name": "파이썬 강사",
    "email": "python@platform.com",
    "businessRegistrationNumber": "",
    "account": {
      "bank": "신한은행",
      "currency": "KRW",
      "number": "110-123-456789",
      "holder": "파이썬 강사",
      "status": "APPROVED"
    },
    "status": "APPROVED",
    "defaultContractId": "lecture_contract_1",
    "memo": "컴싸 강사",
    "tags": ["코딩"],
    "isHidden": false,
    "appliedAt": "2023-07-23T06:35:29.110Z"
  },
  "status": "SETTLED",
  "memo": "string",
  "settlementDate": {
    "year": 2023,
    "month": 7,
    "day": 31
  },
  "payoutId": "payout_1", // 이체 ID는 실제 이체완료 상태값 업데이트 후에 생성됩니다
  "currency": "KRW",
  "isForTest": false,
  "settlementAmount": {
    "order": 1000,
    "payment": 900,
    "platformFee": 100,
    "platformFeeVat": 10,
    "additionalFee": 50,
    "additionalFeeVat": 5,
    "discountShare": 50,
    "discount": 100,
    "settlement": 785
  }
}
```

</div>
</div>
---

## 파트너

<div class="gap-4 md:grid grid-cols-2">
<div>

`파트너` 객체는 가맹점이 정산해줘야할 대상입니다.

기본 사업자 정보와 정산정보, 그리고 적용될 계약의 정보를 등록 및 관리할 수 있습니다.

</div>
<div>

#### Endpoints

```text
POST /platform/partners
POST /platform/partners/batch
GET /platform/partners/{id}
GET /platform/partners/numbered-pages
POST /platform/partners/{id}
POST /platform/partners/{id}/account
POST /platform/partners/{id}/schedule
PUT /platform/partners/{id}/schedule
GET /platform/partners/{id}/schedule
DELETE /platform/partners/{id}/schedule
```

</div>
</div>

---

### 파트너 객체

<div class="gap-4 md:grid grid-cols-2">
<div>

#### Attributes

**id** string

파트너 고유 아이디

---

**name** string

파트너 법인명 혹은 이름

---

**email** string

파트너 이메일

---

**businessRegistrationNumber** string

파트너 사업자번호. 개인 혹은 법인 사업자일때만 존재합니다.

---

**account** dictionary

정산 계좌 Attribute

<table name = "bank_account">
  <tr>
    <td>
    
    account.**bank** enum or string

    은행 이름.

    \- currnecy가 KRW일시 증권사가 제외된 한국 은행 코드별상의 은행값 enum 하단 참고. 해당 은행값 외의 은행은 에러 처리\
    \- currency 가 KRW가 아닐때 해외 은행 string값으로 입력 가능

    </td>

  </tr>
  <tr>
    <td>

    account.**currency** enum

    화페로써 현재로썬 KRW, JPY, USD만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

    account.**number** string

    계좌번호. currency가 KRW일경우 따로 예금주 조회 API를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>
  <tr>
    <td>

    account.**holder** string

    예금주. currency가 KRW일경우 따로 예금주 조회 API를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>
  <tr>
    <td>

    account.**status** enum

    계좌 상태. 현재로썬 승인 대기, 승인 완료, 승인 거절 세가지 상태만 존재한다.

    <table>
      <tr>
        <td>

        **PENDING** : 승인 대기 중

        </td>
      </tr>
      <tr>
        <td>

        **APPROVED** : 승인 완료
        </td>
      </tr>
      <tr>
        <td>

        **REJECTED** : 승인 거절
        </td>
      </tr>
    </table>
    </td>

  </tr>
</table>

---

**defaultContractId** string

파트너의 기본 계약 아이디

기본 계약 아이디란 파트너가 정산을 받을 때 적용되는 계약을 의미합니다. 파트너 정산시 여러개의 계약을 적용 할 수 있으나, 정산 API에 파트너 아이디만 전달 할 경우 기본 계약이 적용됩니다.

---

**memo** string

파트너 메모. 내부 구분용으로 사용하실 수 있습니다.

---

**tags** array

파트너 태그. 내부 구분용으로 사용하실 수 있습니다.

---

**isHidden** boolean

파트너 숨김 여부. true일 경우 파트너 목록에서 숨김 처리됩니다.

숨김이란 soft delete이라고 생각하시면 됩니다.

---

**appliedAt** Datetime

해당 파트너가 업데이트 된 시각

</div>
<div>

#### Response

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "abc@gmail.com",
  "businessRegistrationNumber": null,
  "account": {
    "bank": "신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "APPROVED"
  },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tags": ["개발", "강사"],
  "isHidden": false,
  "appliedAt": "2023-05-07"
}
```

</div>
</div>

---

### 파트너 생성

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**id** optional

파트너에 부여하는 고유 아이디. 가맹점 서버에 등록된 파트너지칭 아이디와 동일해야 합니다. 따로 없다면 포트원이 발급해 드립니다.

---

**name** required

파트너를 지칭하는 사업자명 및 이름

---

**email** optional

파트너 이메일

---

**businessRegistrationNumber** optional

파트너 사업자번호. 검증하지는 않음. 번호 기호 둘다 가능

---

**account** required

account attirbute

<table name = "bank_account">
  <tr>
    <td>
    
    account.**bank** enum or string

    은행 이름.

    \- currnecy가 KRW일시 증권사가 제외된 한국 은행 코드별상의 은행값 enum 하단 참고. 해당 은행값 외의 은행은 에러 처리\
    \- currency 가 KRW가 아닐때 해외 은행 string값으로 입력 가능

    </td>

  </tr>
  <tr>
    <td>

    account.**currency** enum

    화페로써 현재로썬 KRW, JPY, USD만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

    account.**number** string

    계좌번호. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>
  <tr>
    <td>

    account.**holder** string

    예금주. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>

</table>

---

**defaultContractId** required

이미 존재하는 계약객체의 아이디를 등록해야합니다.

---

**memo** optional

256자까지 가능합니다.

---

**tag** optional

최대 10개까지 가능합니다.

---

</div>

<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/partner \
     -u {api_key} \
     -d 'id=lecturer_1' \
     -d 'name=파이선 강사 홍길동' \
     -d 'email=abc@gmail.com' \
     -d 'account={"bank": "신한", "currency": "KRW", "number": "123-45-6789"}' \
     -d 'defaultContractId=contract_1' \
     -d 'memo=파이선 일타 강사, rs 3%' \
     -d 'tag = [개발, 강사]'
```

**Response**

파트너 객체가 반환됩니다.

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "abc@gmail.com",
  "businessRegistrationNumber": null,
  "account": {
    "bank": "신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "Verified"
  },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발", "강사"],
  "isHidden": false,
  "appliedAt": "2023-05-07T07:17:07.064Z"
}
```

</div>
</div>

---

### 파트너 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**id** required

조회하고 싶은 파트너 고유 아이디

---

</div>
<div>
**Request**

```shell
curl -X GET https://api.portone.com/v2/platform/partner/lecturer_1 \
     -u {api_key}
```

**Response**

파트너 객체가 반환됩니다.

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "abc@gmail.com",
  "businessRegistrationNumber": null
  "account":{
    "bank":"신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "Verified",
    },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발","강사"],
  "isHidden": false,
  "updatedAt": "2023-05-07T07:23:34.455"
}
```

</div>
</div>
---

### 파트너 다건 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

페이지 기반으로 여러 파트너를 조회합니다.

**Parameters**

---

**page** optional

요청할 페이지 정보

페이지 번호를 통한 다건 조회 API에 필요한 입력 정보

<table>
  <tr>
    <td>
      page.**size** integer required 각 페이지 당 포함할 객체 수. 기본값은 10
    </td>
  </tr>
  <tr>
    <td>page.**number** integer required 페이지 번호. 0 부터 시작합니다.</td>
  </tr>
</table>
---

**filter** dictionary

다건 조회시 적용하고 싶은 필터 값.

<table name="bank_account">
  <tr>
    <td>
    
    filter.**includeHidden** boolean optional 
    
    true일 경우 숨김 처리된 파트너가 조회됩니다. 
    
    기본값은 false입니다. 
    
    </td>
  </tr>
  <tr>
    <td>
      filter.**tags** list of string optional 파트너에게 부여한 태그 리스트 값.
    </td>
  </tr>
  <tr>
    <td>
      filter.**keyword** one of dictionary 검색 조건. 조건중 한 값을 지정하여
      %like% 검색한다.

      \- keyword.id 파트너 아이디 \
      \- keyword.name 파트너 이름 \
      \- keyword.email 파트너 이메일 \
      \- keyword.businessRegistrationNumber 파트너 사업자 번호 \
      \- keyword.defaultContractId 파트너 기본 계약 아이디 \
      \- keyword.memo 파트너 메모 \
      \- keyword.accountBank 파트너 계좌 은행 \
      \- keyword.accountCurrency 파트너 계좌 통화 \
      \- keyword.accountNumber 파트너 계좌 번호\
      \- keyword.accountHolder 파트너 계좌 예금주

    </td>

  </tr>
</table>

---

  </div>
  <div>
  **Request**

```shell
curl -X POST https://api.portone.com/v2/platform/partners/numbered-pages \
     -u {api_key} \
     -d 'filter[keyword[memo]]=파이선'


```

**Response**

여러 파트너 객체들이 리스트 형태로 반환됩니다.

```json
{
  "items": [
    {
      "id": "lecturer_1",
      "name": "파이선 강사 홍길동",
      "email": "abc@gmail.com",
      "businessRegistrationNumber": null,
      "account": {
        "bank": "신한",
        "currency": "KRW",
        "number": "123-45-6789",
        "holder": "홍길동",
        "status": "Verified"
      },
      "defaultContractId": "contract_1",
      "memo": "파이선 일타 강사, rs 3%",
      "tag": ["개발", "강사"],
      "isHidden": false,
      "appliedAt": "2023-05-07T07:24:48.798Z"
    }
  ],
  "page": {
    "size": 10,
    "number": 0,
    "totalCount": 10
  }
}
```

  </div>
</div>

---

### 파트너 수정

<div class="gap-4 md:grid grid-cols-2">
<div>

주어진 아이디에 대응하는 파트너 정보를 업데이트 합니다.

파트너의 정산계좌 정보를 업데이트 할 경우에는 POST partners/{"{id}"}/account를 통해서 하실 수 있습니다.
**Parameters**

**id** required

수정하고 싶은 파트너의 아이디

---

**name** optional

파트너를 지칭하는 사업자명 및 이름

---

**email** optional

파트너 이메일

---

**businessRegistrationNumber** optional

파트너 사업자번호. 검증하지는 않음. 번호 기호 둘다 가능

---

**defaultContractId** optional

파트너의 기본 계약 아이디. 해당 api를 통해서 계약을 변경 할 경우 적용시점은 api 호출 시점입니다.
따라서 해당 시점기준으로 해당 파트너의 정산건의 **settlementStartDate** 이후의 모든 정산 건에 적용됩니다.

---

**memo** optional

256자까지 가능합니다.

---

**tag** optional

최대 10개까지 가능합니다.

---

**isHidden** optional

파트너를 숨김처리 합니다. 숨김 처리는 soft delete 의 역할을 합니다.

따로 DELETE partner api 없이 해당 파라미터를 통해서 파트너를 숨김처리 하실 수 있습니다.

</div>
<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/partner/lecturer_1 \
     -u {api_key} \
     -d 'email=new@gmail.com' \
     -d 'defaultContract[defaultContractId]=contract_1' \
     -d 'defaultContract[applied_at]=2022-03-01'
```

**Response**

업데이트 된 파트너 객체가 반환됩니다.

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "new@gmail.com",
  "businessRegistrationNumber": null,
  "account": {
    "bank": "신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "Verified"
  },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발", "강사"],
  "isHidden": false,
  "appliedAt": "2023-05-07T00:00:00"
}
```

---

\- 예금주 조회 검증을통해 계좌가 유효하지 않을경우 에러를 반환합니다

    </div>

</div>

---

### 파트너 계좌정보 수정

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

---

**bank** optional enum or string

은행 이름.

\- **currnecy**가 KRW일시 증권사가 제외된 한국 은행 코드별상의 은행값 enum 하단 참고. 해당 은행값 외의 은행은 에러 처리\
\- **currency** 가 KRW가 아닐때 해외 은행 string값으로 입력 가능

---

**currency** optional enum

화페로써 현재로썬 KRW, JPY, USD만 지원한다.

---

**number** optional string

계좌번호. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

---

**holder** optional string

예금주. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.
예금주 조회는 **account** 와 **bank** 만으로 자동 조회 한다.

---

</div>
<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/partner/lecturer_1/account \
     -u {api_key} \
     -d 'bank=우리' \
     -d 'currency=KRW' \
     -d 'number=123-45-6789' \
```

**Response**

업데이트 된 파트너 객체가 반환됩니다.

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "new@gmail.com",
  "businessRegistrationNumber": null,
  "account": {
    "bank": "우리",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "APPROVED"
  },
  "status": "APPROVED",
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발", "강사"],
  "isHidden": false,
  "appliededAt": "2023-05-07T00:00:00"
}
```

</div>
</div>
---

### 파트너 예약 업데이트

<div class="gap-4 md:grid grid-cols-2">
<div>
주어진 아이디에 대응하는 파트너의 업데이트를 예약합니다.

**Parameters**

---

**id** required string

파트너 아이디.

---

**update** required json dicionary

업데이트 할 파트너의 정보를 담은 json dictionary

<table>
  <tr>
    <td>

    **name** optional string

    파트너의 이름

    </td>

  </tr>
  <tr>
    <td>

    **email** optional string

    파트너의 이메일

    </td>

  </tr>
  <tr>
    <td>

    **businessRegistrationNumber** optional string

    파트너의 사업자등록번호

    </td>

  </tr>
  <tr>
    <td>

    **defaultContractId** optional string

    파트너의 기본 계약 아이디

    </td>

  </tr>
  <tr>
    <td>

    **memo** optional string

    파트너에 대한 메모

    </td>

  </tr>
  <tr>
    <td>

    **tags** optional array of string

    파트너에 대한 태그

    </td>

  </tr>
  <tr>
    <td>

    **isHidden** optional boolean

    파트너의 숨김 여부

    </td>

  </tr>
</table>
---

**appliedAt** required Datetime

업데이트를 적용할 시간.
정산 시작일(settlementStartDate) 기준으로 시간이 적용됩니다.
예를들어 2일에 파트너 기본계약 업데이트를 예약했으면 1일까지 정산시작일이 되어있는 해당 파트너의 정산 건은 구버전의 계약이 적용되고
2일부터는 새로운 계약이 적용됩니다.

</div>
<div>

**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/partner/lecturer_1/schedule \
     -u {api_key} \
     -d 'defaultContractId = lecture_contract_2' \
     -d 'appliedAt=2023-06-30T00:00:00'
```

**Response**

성공 응답으로 예약된 파트너 객체가 반환됩니다.

```json
{
  "scheduledPartner": {
    "id": "lecturer_1",
    "name": "파이선 강사 홍길동",
    "email": "new@gmail.com",
    "businessRegistrationNumber": null,
    "account": {
      "bank": "우리",
      "currency": "KRW",
      "number": "123-45-6789",
      "holder": "홍길동",
      "status": "APPROVED"
    },
    "status": "APPROVED",
    "defaultContractId": "contract_1",
    "memo": "파이선 일타 강사, rs 3%",
    "tag": ["개발", "강사"],
    "isHidden": false,
    "appliededAt": "2023-06-30T00:00:00"
  }
}
```

</div>
</div>

### 파트너 예약 업데이트 재설정

<div class="gap-4 md:grid grid-cols-2">
<div>
주어진 아이디에 대응하는 파트너의 업데이트를 재설정 합니다.
기존에 예약이 예정되어 있는 업데이트가 있다면 취소되고 새로운 업데이트가 예약됩니다.

**Parameters**

---

**id** required string

파트너 아이디.

---

**update** required json dicionary

업데이트 할 파트너의 정보를 담은 json dictionary

<table>
  <tr>
    <td>

    **name** optional string

    파트너의 이름

    </td>

  </tr>
  <tr>
    <td>

    **email** optional string

    파트너의 이메일

    </td>

  </tr>
  <tr>
    <td>

    **businessRegistrationNumber** optional string

    파트너의 사업자등록번호

    </td>

  </tr>
  <tr>
    <td>

    **defaultContractId** optional string

    파트너의 기본 계약 아이디

    </td>

  </tr>
  <tr>
    <td>

    **memo** optional string

    파트너에 대한 메모

    </td>

  </tr>
  <tr>
    <td>

    **tags** optional array of string

    파트너에 대한 태그

    </td>

  </tr>
  <tr>
    <td>

    **isHidden** optional boolean

    파트너의 숨김 여부

    </td>

  </tr>
</table>
---

**appliedAt** required Datetime

업데이트를 적용할 시간.
정산 시작일(settlementStartDate) 기준으로 시간이 적용됩니다.
예를들어 2일에 파트너 기본계약 업데이트를 예약했으면 1일까지 정산시작일이 되어있는 해당 파트너의 정산 건은 구버전의 계약이 적용되고
2일부터는 새로운 계약이 적용됩니다.

</div>
<div>

**Request**

```shell
curl -X PUT https://api.portone.com/v2/platform/partner/lecturer_1/schedule \
     -u {api_key} \
     -d 'defaultContractId = lecture_contract_2' \
     -d 'appliedAt=2023-07-01T00:00:00'
```

**Response**

성공 응답으로 예약된 파트너 객체가 반환됩니다.

```json
{
  "scheduledPartner": {
    "id": "lecturer_1",
    "name": "파이선 강사 홍길동",
    "email": "new@gmail.com",
    "businessRegistrationNumber": null,
    "account": {
      "bank": "우리",
      "currency": "KRW",
      "number": "123-45-6789",
      "holder": "홍길동",
      "status": "APPROVED"
    },
    "status": "APPROVED",
    "defaultContractId": "contract_1",
    "memo": "파이선 일타 강사, rs 3%",
    "tag": ["개발", "강사"],
    "isHidden": false,
    "appliededAt": "2023-07-01T00:00:00"
  }
}
```

</div>
</div>

---

### 파트너 예약 업데이트 취소

<div class="gap-4 md:grid grid-cols-2">
<div>
주어진 아이디에 대응하는 파트너의 업데이트를 취소합니다.

**Parameters**

---

**id** required string

파트너 아이디.

</div>
<div>

**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/partner/lecturer_1/schedule \
     -u {api_key}
```

**Response**
성공 응답(200) 이 반환됩니다.

</div>
</div>

## 계약

<div class="gap-4 md:grid grid-cols-2">
<div>
`계약` 객체는 가맹점이 파트너에게 정산해줄 대금과 정산일을 계산하는데 적용되는 정보입니다.

가맹점의 플랫폼에서 재화 및 서비스를 판매하는데에 대한 중개수수료정보와 판매금에 대한 정산을 언제 해주는지 알려주는 정산일로 구성되어 있습니다.

</div>
<div>
**Endpoints**

```text
POST /platform/contracts
GET /platform/contract/{id}
POST /platform/contract/{id}
POST /platform/contracts/numered-pages
POST /platform/contracts/{id}/schedule
PUT /platform/contracts/{id}/schedule
GET /platform/contracts/{id}/schedule
DELETE /platform/contracts/{id}/schedule
```

</div>
</div>

---

### 계약 객체

<div class="gap-4 md:grid grid-cols-2">
<div>
Attributes

**id** string

계약객체의 고유 아이디

---

**memo** string

계약객체 내부 표기를 위한 메모

---

**platformFee** dictionary

중개수수료. 기본 **Fee** attribute 을 사용한다.

<table>
  <tr>
    <td>

      platformFee.**fixedAmount** int64

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

      platformFee.**fixedRate** int64

      정률일 경우 10^-9표기. 즉 10% → 100000000 으로 입력.

    </td>

  </tr>
</table>

---

**settlementCycle** dictionary

정산주기 Attribute. 지체일, 정산일, 기준일로 구성되어있다. 해당 요소들의 조합으로 정산일을 계산한다.

<table name="settlementCycle">
  <tr>
    <td>

      settlementCycle.**lagDays** int64

      지체일(d+n의 n).정산시작일(통상주문완료일) 로 부터 더해진다음 날짜로부터 가장 가까운 날에 정산이 된다. 최소 1 최대 10 까지 지정할 수 있다.

    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**datePolicy** enum

      기준일이며 정산일 계산시 공휴일을 고려하기 위함이다. 값은 달력일, 전 영업일, 후 영업일 이렇게 3가지가 있다.
      값: CALENDAR_DAY, HOLIDAY_BEFORE, HOLIDAY_AFTER

      <table>
        <tr>
          <td>

            **CALENDAR_DAY** 달력일. 정산일 계산시 공휴일을 고려하지 않습니다.

          </td>
        </tr>
        <tr>
          <td>

            **HOLIDAY_BEFORE** 전 영업일. 정산일 계산시 공휴일을 고려하여 공휴일이 정산일이 되는 경우에는 공휴일 전 영업일로 정산일을 계산합니다.

          </td>
        </tr>
        <tr>
          <td>

            **HOLIDAY_AFTER** 후 영업일. 정산일 계산시 공휴일을 고려하여 공휴일이 정산일이 되는 경우에는 공휴일 후 영업일로 정산일을 계산합니다.

          </td>
        </tr>
      </table>

    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**method** dictionary

      정산주기 관련되서 매일, 주에 n회, 달에 n회, 특정 분기 혹은 지정된 날짜에 정산을 할수 있도록 정산주기의 기간별 종류를 정할 수 있다. 값으론 daily, weekly, monthly, manualDates 가 있습니다.

      계약별 정산 주기의 method는 매일, 주 n회, 달 n회, 지정된 날짜 중 하나만 택할 수 있습니다.

    <table>
      <tr>
        <td>

        method.**daily** json dicionary

        정산 주기가 매일일때 단순히 빈 json '{}' 을 입력하면 됩니다.

        혹시나 격일 과 같은 특정 패턴에 정산을 지정하고 싶으시면 문의 부탁드립니다.

        </td>
      </tr>
      <tr>
        <td>

          method.**weekly** dicionary

          weekly attribute

          <table>
            <tr>
              <td>

                weekly.**dayOfWeek** enum

                정산 주기가 주 n회일때 n, 특정 요일들을 지정 할 수 있습니다. 최대 두가지 요일을 지정 할 수 있습니다.
                i.e. ['MON', 'WED'] 는 매주 월요일, 수요일에 정산을 한다는 의미입니다.
                두가지 이상의 요일을 지정 하고 싶으시면 문의 부탁드립니다.

                요일 enum

                <table>
                  <tr>
                    <td>

                      **MON** 월요일

                    </td>
                  </tr>
                  <tr>
                    <td>

                      **TUE** 화요일

                    </td>
                  </tr>
                  <tr>
                    <td>

                      **WED** 수요일

                    </td>
                  </tr>
                  <tr>
                    <td>

                      **THU** 목요일

                    </td>
                  </tr>
                  <tr>
                    <td>

                      **FRI** 금요일

                    </td>
                  </tr>
                  <tr>
                    <td>

                      **SAT** 토요일

                    </td>
                  </tr>
                  <tr>
                    <td>

                      **SUN** 일요일

                    </td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>

          method.**monthly** dictionary

          monthly attribute

          <table>
            <tr>
              <td>

                monthly.**dayOfMonth** list of int64

                정산 주기가 달 n회일때 n, 특정 날짜들을 지정 할 수 있습니다. 최대 두가지 날짜를 지정 할 수 있습니다.
                i.e. [1, 15] 는 매월 1일, 15일에 정산을 한다는 의미입니다.

                31 의 경우에는 월말로 지정됩니다.

                두가지 이상의 날짜를 지정 하고 싶으시면 문의 부탁드립니다.

              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>

          method.**manualDates** dicionary

          manualDates attribute

          <table>
            <tr>
              <td>

                manualDates.**dates**

                정산 주기가 특정 분기 혹은 지정된 날짜('MM-DD')일때 지정된 날짜들을 지정 할 수 있습니다. 최대 여덜가지 날짜를 지정 할 수 있습니다.

                dates attribute

                <table>
                  <tr>
                    <td>

                      dates.**month** int64

                      달로써 1-12 사이의 값을 가집니다.

                    </td>
                  </tr>
                  <tr>
                    <td>

                      dates.**day** int64

                      일로써 1-31 사이의 값을 가집니다.

                      만약에 없는 일을 지정할 경우 에러를 반환합니다.

                    </td>
                  </tr>
                </table>

                여덜가지 이상의 날짜를 지정 하고 싶으시면 문의 부탁드립니다.

              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
    </td>

  </tr>
</table>

- 정산주기 값 설정 예시

```javascript
settlementCycle = {
  lay_days: 3,
  method: {
    monthly: {
      dayOfMonth: [15, 31],
    },
  },
  datePolicy: "HOLIDAY_BEFORE",
};
```

case 1: 10일 주문완료 (settlementStartDate)

- d + 3일 = 13일
- 13일의 그다음 정산일 = 15일
- if 15일이 영업일이라면 정산일 = 15일
- elif 15일이 영업일이 아니라면 i.e. 토요일 이라면 정산일 = 14일

case 2: 13일 주문완료

- d + 3일 = 16일
- 16일의 그다음 정산일 = 31일
- if 31일이 영업일이라면 정산일 = 31일
- elif 31일이 영업일이 아니라면 i.e. 토요일 이라면 정산일 = 30일

---

**vatPayer** enum

해당 계약의 중개수수료에 대해서 부가세 포함 여부.
값: PARTNER, MERCHANT

**PARTNER**: 부가세 파트너 부담

**MERCHANT**: 부가세 파트너 미부담

---

**isHidden** boolean

계약 객체 숨기처리 여부. 숨김 처리는 soft delete이라고 생각하시면 됩니다.

---

**appliedAt** Datetime

계약 객체가 업데이트 된 시점.

---

</div>
<div>
**Response (월별 정산)**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "rate": "100000000"
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": {
      "monthly": {
        "daysOfMonth": [15, 31]
      }
    },
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isHidden": false,
  "appliedAt": "2020-01-01T00:00:00Z"
}
```

**Response (일별 정산)**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "rate": "100000000"
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": {
      "daily": {}
    },
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isHidden": false
}
```

**Response (주별 정산)**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "rate": "100000000"
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": {
      "weekly": {
        "daysOfWeek": ["FRI"]
      }
    },
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isHidden": false,
  "appliedAt": "2021-01-01T00:00:00Z"
}
```

**Response (월-일 정산)**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "rate": "100000000"
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": {
      "manualDates": {
        "dates": [
          {
            "month": 1,
            "day": 1
          },
          {
            "month": 9,
            "day": 1
          }
        ]
      }
    },
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isHidden": false,
  "appliedAt": "2021-01-01T00:00:00Z"
}
```

</div>
</div>

---

### 계약 생성

<div class="gap-4 md:grid grid-cols-2">
<div>
새로운 계약을 생성합니다.

**Parameters**

**id** optional string

계약객체에 부여하는 고유 아이디. 전달하지 않을경우 response에서 포트원이 임의로 발급해 드립니다.

---

**memo** optional string

계약객체 내부 표기를 위한 메모

---

**platformFee** required dictionary

중개수수료. 기본 **Fee** attribute 을 사용한다.

**fixedAmount** (정액 수수료) 혹은 **fixedRate** (정률 수수료) 둘 중 하나만 전달 하셔야 합니다.

<table>
  <tr>
    <td>

      platformFee.**fixedAmount** int64

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.
    </td>

  </tr>
  <tr>
    <td>

      platformFee.**fixedRate** int64

      정률일 경우 10^-9표기. 즉 10% → 100000000 으로 입력.
    </td>

  </tr>
</table>

---

**settlementCycle** required dictionary

정산주기 Attribute. 지체일, 정산일, 기준일로 구성되어있다. 해당 요소들의 조합으로 정산일을 계산한다.

<table name="settlementCycle">
  <tr>
    <td>

      settlementCycle.**lagDays** int64

      지체일(d+n의 n).정산시작일(통상주문완료일) 로 부터 더해진다음 날짜로부터 가장 가까운 날에 정산이 된다. 최소 1 최대 10 까지 지정할 수 있다.

    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**datePolicy** enum

      기준일이며 정산일 계산시 공휴일을 고려하기 위함이다. 값은 달력일, 전 영업일, 후 영업일 이렇게 3가지가 있다.
      값: CALENDAR_DAY, HOLIDAY_BEFORE, HOLIDAY_AFTER

      <table>
        <tr>
          <td>

            **CALENDAR_DAY** 달력일. 정산일 계산시 공휴일을 고려하지 않습니다.

          </td>
        </tr>
        <tr>
          <td>

            **HOLIDAY_BEFORE** 전 영업일. 정산일 계산시 공휴일을 고려하여 공휴일이 정산일이 되는 경우에는 공휴일 전 영업일로 정산일을 계산합니다.

          </td>
        </tr>
        <tr>
          <td>

            **HOLIDAY_AFTER** 후 영업일. 정산일 계산시 공휴일을 고려하여 공휴일이 정산일이 되는 경우에는 공휴일 후 영업일로 정산일을 계산합니다.

          </td>
        </tr>
      </table>

    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**method** dictionary

      정산주기 관련되서 매일, 주에 n회, 달에 n회, 특정 분기 혹은 지정된 날짜에 정산을 할수 있도록 정산주기의 기간별 종류를 정할 수 있다. 값으론 daily, weekly, monthly, manualDates 가 있습니다.

      계약별 정산 주기의 method는 매일, 주 n회, 달 n회, 지정된 날짜 중 하나만 택할 수 있습니다.

      <table>
        <tr>
          <td>

            method.**daily** json dicionary

            정산 주기가 매일일때 단순히 빈 json '{}' 을 입력하면 됩니다.

            혹시나 격일 과 같은 특정 패턴에 정산을 지정하고 싶으시면 문의 부탁드립니다.

          </td>
        </tr>
        <tr>
          <td>

            method.**weekly** dicionary

            weekly attribute

            <table>
              <tr>
                <td>

                  weekly.**dayOfWeek** enum

                  정산 주기가 주 n회일때 n, 특정 요일들을 지정 할 수 있습니다. 최대 두가지 요일을 지정 할 수 있습니다.
                  i.e. ['MON', 'WED'] 는 매주 월요일, 수요일에 정산을 한다는 의미입니다.
                  두가지 이상의 요일을 지정 하고 싶으시면 문의 부탁드립니다.

                  요일 enum

                  <table>
                    <tr>
                      <td>

                        **MON** 월요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **TUE** 화요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **WED** 수요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **THU** 목요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **FRI** 금요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **SAT** 토요일
                      </td>
                    </tr>
                    <tr>
                      <td>

                        **SUN** 일요일

                      </td>
                    </tr>
                  </table>

                </td>
              </tr>
            </table>

          </td>
        </tr>
        <tr>
          <td>

            method.**monthly** dictionary

            monthly attribute

            <table>
              <tr>
                <td>
                  monthly.**dayOfMonth** list of int64

                  정산 주기가 달 n회일때 n, 특정 날짜들을 지정 할 수 있습니다. 최대 두가지 날짜를 지정 할 수 있습니다.
                  i.e. [1, 15] 는 매월 1일, 15일에 정산을 한다는 의미입니다.

                  31 의 경우에는 월말로 지정됩니다.

                  두가지 이상의 날짜를 지정 하고 싶으시면 문의 부탁드립니다.

                </td>
              </tr>
            </table>

          </td>
        </tr>
        <tr>
          <td>

            method.**manualDates** dicionary

            manualDates attribute

            <table>
              <tr>
                <td>

                  manualDates.**dates**

                  정산 주기가 특정 분기 혹은 지정된 날짜('MM-DD')일때 지정된 날짜들을 지정 할 수 있습니다. 최대 여덜가지 날짜를 지정 할 수 있습니다.

                  dates attribute

                  <table>
                    <tr>
                      <td>

                        dates.**month** int64

                        달로써 1-12 사이의 값을 가집니다.

                      </td>
                    </tr>
                    <tr>
                      <td>

                        dates.**day** int64

                        일로써 1-31 사이의 값을 가집니다.

                        만약에 없는 일을 지정할 경우 에러를 반환합니다.
                      </td>
                    </tr>
                  </table>

                  여덜가지 이상의 날짜를 지정 하고 싶으시면 문의 부탁드립니다.

                </td>
              </tr>
            </table>

          </td>
        </tr>
      </table>
    </td>

  </tr>
</table>

- 정산주기 값 설정 예시

```javascript
settlementCycle = {
  lay_days: 3,
  method: {
    monthly: {
      dayOfMonth: [15, 31],
    },
  },
  datePolicy: "HOLIDAY_BEFORE",
};
```

case 1: 10일 주문완료 (settlementStartDate)

- d + 3일 = 13일
- 13일의 그다음 정산일 = 15일
- if 15일이 영업일이라면 정산일 = 15일
- elif 15일이 영업일이 아니라면 i.e. 토요일 이라면 정산일 = 14일

case 2: 13일 주문완료

- d + 3일 = 16일
- 16일의 그다음 정산일 = 31일
- if 31일이 영업일이라면 정산일 = 31일
- elif 31일이 영업일이 아니라면 i.e. 토요일 이라면 정산일 = 30일

---

**vatPayer** optional

부가세 여부

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

</div>
<div>

**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/contract \
     -u {api_key} \
     -d 'id=contract_1' \
     -d 'platformFee[fixedRate]=100000000' \
     -d 'settlementCycle[lagDays]=3' \
     -d 'settlementCycle[method]={ monthly:{ daysOfMonth: [15,31]}}' \
     -d 'settlementCycle[datePolicy]=HOLIDAY_BEFORE' \
     -d 'vatPayer=PARTNER' \
     -d 'memo=셀러 기본 계약 1'

```

**Response**

생성된 계약 객체가 반환됩니다.

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "rate": 100000000
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "monthly",
    "method": {
      "monthly": {
        "daysOfMonth": [15, 31]
      }
    },
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isHidden": false,
  "appliedAt": "2021-01-01T00:00:00Z"
}
```

</div>
</div>

---

### 계약 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

None

</div>
<div>

**Request**

```shell
curl https://api.portone.com/v2/platform/contract/{id}\
     -u {api_key}\
```

**Response**

조회한 아이디의 계약객체가 반환됩니다.

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "rate": 100000000
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "monthly",
    "method": {
      "monthly": {
        "daysOfMonth": [15, 31]
      }
    },
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isHidden": false,
  "appliedAt": "2021-01-01T00:00:00Z"
}
```

</div>
</div>

---

### 계약 수정

<div class="gap-4 md:grid grid-cols-2">
<div>

주어진 아이디에 대응되는 계약을 업데이트합니다.

해당 api는 호출 시점에 변경사항을 적용합니다. 변경사항을 미래 시점에 적용하고 싶다면 POST /v2/platform/contracts/{'{id}'}/schedule api를 사용하세요.

계약을 업데이트 하면 api 호출 시점 이후의 **settlementStartDate**를 가진 해당 계약의 정산에 변경사항이 적용됩니다.

**Parameters**

**id** required string

업데이트 하고자 하는 계약의 아이디

---

**memo** optional string

계약객체 내부 표기를 위한 메모

---

**platformFee** required dictionary

중개수수료. 기본 **Fee** attribute 을 사용한다.

**fixedAmount** (정액 수수료) 혹은 **fixedRate** (정률 수수료) 둘 중 하나만 전달 하셔야 합니다.

<table>
  <tr>
    <td>

      platformFee.**fixedAmount** int64

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

      platformFee.**fixedRate** int64

      정률일 경우 10^-9표기. 즉 10% → 100000000 으로 입력.

    </td>

  </tr>
</table>

---

**settlementCycle** required dictionary

정산주기 Attribute. 지체일, 정산일, 기준일로 구성되어있다. 해당 요소들의 조합으로 정산일을 계산한다.

<table name="settlementCycle">
  <tr>
    <td>

      settlementCycle.**lagDays** int64

      지체일(d+n의 n).정산시작일(통상주문완료일) 로 부터 더해진다음 날짜로부터 가장 가까운 날에 정산이 된다. 최소 1 최대 10 까지 지정할 수 있다.

    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**datePolicy** enum

      기준일이며 정산일 계산시 공휴일을 고려하기 위함이다. 값은 달력일, 전 영업일, 후 영업일 이렇게 3가지가 있다.
      값: CALENDAR_DAY, HOLIDAY_BEFORE, HOLIDAY_AFTER

      <table>
        <tr>
          <td>

            **CALENDAR_DAY** 달력일. 정산일 계산시 공휴일을 고려하지 않습니다.

          </td>
        </tr>
        <tr>
          <td>

            **HOLIDAY_BEFORE** 전 영업일. 정산일 계산시 공휴일을 고려하여 공휴일이 정산일이 되는 경우에는 공휴일 전 영업일로 정산일을 계산합니다.

          </td>
        </tr>
        <tr>
          <td>

            **HOLIDAY_AFTER** 후 영업일. 정산일 계산시 공휴일을 고려하여 공휴일이 정산일이 되는 경우에는 공휴일 후 영업일로 정산일을 계산합니다.

          </td>
        </tr>
      </table>
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**method** dictionary

      정산주기 관련되서 매일, 주에 n회, 달에 n회, 특정 분기 혹은 지정된 날짜에 정산을 할수 있도록 정산주기의 기간별 종류를 정할 수 있다. 값으론 daily, weekly, monthly, manualDates 가 있습니다.

      계약별 정산 주기의 method는 매일, 주 n회, 달 n회, 지정된 날짜 중 하나만 택할 수 있습니다.

      <table>
        <tr>
          <td>

            method.**daily** json dicionary

            정산 주기가 매일일때 단순히 빈 json '{}' 을 입력하면 됩니다.

            혹시나 격일 과 같은 특정 패턴에 정산을 지정하고 싶으시면 문의 부탁드립니다.

          </td>
        </tr>
        <tr>
          <td>

            method.**weekly** dicionary

            weekly attribute

            <table>
              <tr>
                <td>

                  weekly.**dayOfWeek** enum

                  정산 주기가 주 n회일때 n, 특정 요일들을 지정 할 수 있습니다. 최대 두가지 요일을 지정 할 수 있습니다.
                  i.e. ['MON', 'WED'] 는 매주 월요일, 수요일에 정산을 한다는 의미입니다.
                  두가지 이상의 요일을 지정 하고 싶으시면 문의 부탁드립니다.

                  요일 enum

                  <table>
                    <tr>
                      <td>

                        **MON** 월요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **TUE** 화요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **WED** 수요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **THU** 목요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **FRI** 금요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **SAT** 토요일

                      </td>
                    </tr>
                    <tr>
                      <td>

                        **SUN** 일요일

                      </td>
                    </tr>
                  </table>

                </td>
              </tr>
            </table>

          </td>
        </tr>
        <tr>
          <td>

            method.**monthly** dictionary

            monthly attribute

            <table>
              <tr>
                <td>

                  monthly.**dayOfMonth** list of int64

                  정산 주기가 달 n회일때 n, 특정 날짜들을 지정 할 수 있습니다. 최대 두가지 날짜를 지정 할 수 있습니다.
                  i.e. [1, 15] 는 매월 1일, 15일에 정산을 한다는 의미입니다.

                  31 의 경우에는 월말로 지정됩니다.

                  두가지 이상의 날짜를 지정 하고 싶으시면 문의 부탁드립니다.

                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td>

            method.**manualDates** dicionary

            manualDates attribute

            <table>
              <tr>
                <td>

                  manualDates.**dates**

                  정산 주기가 특정 분기 혹은 지정된 날짜('MM-DD')일때 지정된 날짜들을 지정 할 수 있습니다. 최대 여덜가지 날짜를 지정 할 수 있습니다.

                  dates attribute

                  <table>
                    <tr>
                      <td>

                        dates.**month** int64

                        달로써 1-12 사이의 값을 가집니다.

                      </td>
                    </tr>
                    <tr>
                      <td>

                        dates.**day** int64

                        일로써 1-31 사이의 값을 가집니다.

                        만약에 없는 일을 지정할 경우 에러를 반환합니다.

                      </td>
                    </tr>
                  </table>

                  여덜가지 이상의 날짜를 지정 하고 싶으시면 문의 부탁드립니다.

                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>

  </tr>
</table>

- 정산주기 값 설정 예시

```javascript
settlementCycle = {
  lay_days: 3,
  method: {
    monthly: {
      dayOfMonth: [15, 31],
    },
  },
  datePolicy: "HOLIDAY_BEFORE",
};
```

case 1: 10일 주문완료 (settlementStartDate)

- d + 3일 = 13일
- 13일의 그다음 정산일 = 15일
- if 15일이 영업일이라면 정산일 = 15일
- elif 15일이 영업일이 아니라면 i.e. 토요일 이라면 정산일 = 14일

case 2: 13일 주문완료

- d + 3일 = 16일
- 16일의 그다음 정산일 = 31일
- if 31일이 영업일이라면 정산일 = 31일
- elif 31일이 영업일이 아니라면 i.e. 토요일 이라면 정산일 = 30일

---

**vatPayer** optional enum

부가세 여부

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

**isHidden** optional boolean

계약 숨김 여부. 기본 값은 false 입니다.

</div>
<div>

**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/contract/{id} \
     -u {api_key} \
     -d 'settlementCycle[lagDays]=2' \
     -d 'settlementCycle[method]={weekly : {daysOfWeek : [FRI] }}'

```

**Response**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "rate": 100000000
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "monthly",
    "method": {
      "weekly": {
        "daysOfWeek": ["FRI"]
      }
    },
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isHidden": false,
  "appliedAt": "2021-01-01T00:00:00Z" //api 호출 시점
}
```

  </div>
</div>

---

### 계약 다건 조회 (TBU)

<div class="gap-4 md:grid grid-cols-2">
<div>

페이지 기반으로 여러 계약을 조회합니다.

**page** optional

요청할 페이지 정보

페이지 번호를 통한 다건 조회 API에 필요한 입력 정보

<table>
  <tr>
    <td>

      page.**size** integer required 각 페이지 당 포함할 객체 수. 기본값은 10

    </td>

  </tr>
  <tr>
    <td>

      page.**number** integer required 페이지 번호. 0 부터 시작합니다.

    </td>

  </tr>
</table>
---

**filter** dictionary

다건 조회시 적용하고 싶은 필터 값.

<table name="bank_account">
  <tr>
    <td>

      filter.**includeHidden** boolean optional

      true일 경우 숨김 처리된 파트너가 조회됩니다.

      기본값은 false입니다.

    </td>

  </tr>
  <tr>
    <td>

      filter.**tags** list of string optional 파트너에게 부여한 태그 리스트 값.

    </td>

  </tr>
  <tr>
    <td>

      filter.**keyword** one of dictionary 검색 조건. 조건중 한 값을 지정하여
      %like% 검색한다.

    </td>

  </tr>
</table>

---

</div>
<div>

**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/contract/{id}/numbered-pages \
     -u {api_key}
```

**Response**

request로 전달된 검색조건에 대응하는 여러 계약들이 반환됩니다.

```json
{
  "items": [
    {
      "id": "contract_1",
      "memo": "셀러 기본 계약 1",
      "platformFee": {
        "rate": 100000000
      },
      "settlementCycle": {
        "lagDays": 3,
        "method": "monthly",
        "method": {
          "weekly": {
            "daysOfWeek": ["FRI"]
          }
        },
        "datePolicy": "HOLIDAY_BEFORE"
      },
      "vatPayer": "PARTNER",
      "isHidden": false,
      "appliedAt": "2021-01-01T00:00:00Z" //api 호출 시점
    } /// ...
  ],
  "page": {
    "size": 10,
    "number": 0,
    "totalCount": 10
  }
}
```

</div>
</div>

---

### 계약 예약 업데이트

<div class="gap-4 md:grid grid-cols-2">
<div>

주어진 아이디에 대응되는 계약에 업데이트를 예약합니다.

"update" 필드에 업데이트를 예약할 정보를 입력합니다.

"appliedAt" 필드에 적용되길 원하는 시점을 입력합니다.

**Parameter**

**update** dictionary required

예약 업데이트 하고 싶은 계약 정보
기존 [계약 수정](#계약-수정) API와 동일한 파라미터를 사용합니다.

**appliedAt** Datetime required

업데이트가 적용되길 원하는 시점 입니다.다.

**settlementStartDate** 기접으로 적용됩니다. 예를 들어 appliedAt 이 t-0 이라면 t-0 이후의 settlementStartDate 인 해당 계약의 정산건들은 업데이트가 적용됩니다.

</div>
<div>

**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/contract/{id}/schedule \
     -u {api_key} \
     -d 'update[settlementCycle[lagDays]]=2' \
     -d 'update[settlementCycle[method]]={weekly : {daysOfWeek : [FRI] }}'\
     -d 'appliedAt=2023-05-01T00:00:00Z'
```

**Response**

```json
{
  "scheduledContract": {
    "id": "contract_1",
    "memo": "셀러 기본 계약 1",
    "platformFee": {
      "rate": 100000000
    },
    "settlementCycle": {
      "lagDays": 2,
      "method": "weekly",
      "method": {
        "weekly": {
          "daysOfWeek": ["FRI"]
        }
      },
      "datePolicy": "HOLIDAY_BEFORE"
    },
    "vatPayer": "PARTNER",
    "isHidden": false,
    "appliedAt": "2023-05-01T00:00:00Z" //예약 시점
  }
}
```

</div>
</div>

---

### 계약 예약 업데이트 재설정

<div class="gap-4 md:grid grid-cols-2">
<div>

주어진 아이디에 대응되는 계약에 예약 업데이트를 재설정합니다.

"update" 필드에 업데이트를 예약할 정보를 입력합니다.

"appliedAt" 필드에 적용되길 원하는 시점을 입력합니다.

해당 계약 에 대해서 이미 예약 업데이트가 존재하는 경우에는 해당 api를 사용해야하며 , 해당 api를 통해 업데이트 할경우 기존 예약 업데이트는 삭제됩니다.

**Parameter**

**update** dictionary required

예약 업데이트 하고 싶은 계약 정보
기존 [계약 수정](#계약-수정) API와 동일한 파라미터를 사용합니다.

**appliedAt** Datetime required

업데이트가 적용되길 원하는 시점 입니다.다.

**settlementStartDate** 기접으로 적용됩니다. 예를 들어 appliedAt 이 t-0 이라면 t-0 이후의 settlementStartDate 인 해당 계약의 정산건들은 업데이트가 적용됩니다.

</div>
<div>

**Request**

```shell
curl -X PUT https://api.portone.com/v2/platform/contract/{id}/schedule \
     -u {api_key} \
     -d 'update[settlementCycle[lagDays]]=2' \
     -d 'update[settlementCycle[method]]={weekly : {daysOfWeek : [MON] }}'\
     -d 'appliedAt=2023-06-01T00:00:00Z'
```

**Response**

```json
{
  "scheduledContract": {
    "id": "contract_1",
    "memo": "셀러 기본 계약 1",
    "platformFee": {
      "rate": 100000000
    },
    "settlementCycle": {
      "lagDays": 2,
      "method": "weekly",
      "method": {
        "weekly": {
          "daysOfWeek": ["MON"]
        }
      },
      "datePolicy": "HOLIDAY_BEFORE"
    },
    "vatPayer": "PARTNER",
    "isHidden": false,
    "appliedAt": "2023-06-01T00:00:00Z" //예약 시점
  }
}
```

</div>
</div>

---

### 계약 예약 업데이트 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

주어진 아이디에 대응되는 계약에 예약 업데이트를 조회합니다

**Parameter**

**id** required string

예약 업데이트를 조회할 계약의 아이디

</div>
<div>

**Request**

```shell
curl -X GET https://api.portone.com/v2/platform/contract/contract_1/schedule \
     -u {api_key} \
```

**Response**

```json
{
  "scheduledContract": {
    "id": "contract_1",
    "memo": "셀러 기본 계약 1",
    "platformFee": {
      "rate": 100000000
    },
    "settlementCycle": {
      "lagDays": 2,
      "method": "weekly",
      "method": {
        "weekly": {
          "daysOfWeek": ["MON"]
        }
      },
      "datePolicy": "HOLIDAY_BEFORE"
    },
    "vatPayer": "PARTNER",
    "isHidden": false,
    "appliedAt": "2023-06-01T00:00:00Z" //예약 시점
  }
}
```

</div>
</div>

---

### 계약 예약 업데이트 삭제

<div class="gap-4 md:grid grid-cols-2">
<div>

주어진 아이디에 대응되는 계약에 예약 업데이트를 조회합니다

**Parameter**

**id** required string

예약 업데이트를 삭제 할 계약의 아이디

</div>
<div>

**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/contract/contract_1/schedule \
     -u {api_key} \
```

**Response**

200 성공 응답. 삭제된 예약 업데이트는 조회되지 않습니다.

</div>
</div>

---

## 할인 유형

<div class="gap-4 md:grid grid-cols-2">
<div>

`할인 유형` 객체는 가맹점의 주문건에 대해서 쿠폰 및 포인트와 같은 할인금액이 적용될시 이에대해서 파트너 정산에 할인금과 할인에 따른 파트너와의 분담율을 적용하고자 사용할 수 있는 객체입니다.

할인 유형에 대한 아이디와 메모 그리고 파트너 분담율로 정보 구성이 되어있습니다.

</div>
<div>

**Endpoints**

```text
POST /platform/discount-shares
GET /platform/discount-shares/{id}
GET /platform/discount-shares/numbered-pages
POST /platform/discount-shares/{id}
DELETE /platform/discount-shares/{id}
```

</div>
</div>

---

### 할인 유형 생성

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**id** optional

할인 유형 고유아이디. 가맹점 서버에 저장되고 통용되는 아이디로 지정해주세요. 없다면 포트원에서 임의로 발급해드리며 이를 저장해주세요.

---

**partnerShareRate** optional 기본값은 0

할인 분담율. 10^-9처리 값입니다. 예) 10% = 100000000

---

**memo** optional

할인 유형 내부 메모. 예) 파트너 브랜드 쿠폰

</div>
<div>

**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/discount-shares \
     -u {api_key} \
     -d 'id=coupon_1' \
     -d 'partnerShareRate=100000000' \
     -d 'memo=파트너 브랜드 쿠폰'
```

**Response**

생성된 할인 유형 객체가 반환됩니다.

```json
{
  "id": "coupon_1",
  "partnerShareRate": 100000000,
  "memo": "파트너 브랜드 쿠폰",
  "isDeleted": false
}
```

</div>
</div>

---

### 할인 유형 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

None

</div>
<div>

**Request**

```shell
curl -X GET https://api.portone.com/v2/platform/discount-shares/{id} \
     -u {api_key}
```

**Response**

조회 대상 할인 유형이 반환됩니다.

```json
{
  "id": "coupon_1",
  "partnerShareRate": 100000000,
  "memo": "파트너 브랜드 쿠폰",
  "isDeleted": false
}
```

</div>
</div>

---

### 할인 유형 다건 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**page** optional

페이지 기반의 다건 조회 갯수 조건

page attributes

<table name="bank_account">
  <tr>
    <td>

      page.**number** optional 기본값은 1

      검색 결과에대한 페이징. size에 따라 offset 값이라고 생각하면 됩니다.

    </td>

  </tr>
  <tr>
    <td>

      page.**size** optional 기본값은 10

      각 page당 조회될 할인 유형 객체 갯수.

    </td>

  </tr>
</table>

---

**filter** required

검색 조건

filter attributes

<table name="bank_account">
  <tr>
    <td>

      filter.**includeDeleted** boolean optional 기본값은 false

      true로 설정시 삭제된 할인 유형 객체도 조회됩니다.

    </td>

  </tr>
  <tr>
    <td>

      filter.**partnerShareRates** list of int64 optional

      파트너 분담율로 구성된 리스트. 해당 리스트에 포함된 분담율과 매칭되는 모든 할인 유형 객체들을 반환한다.

    </td>

  </tr>
  <tr>
    <td>

      filter.**keyword** dictionary optional

      통합검색을 위한 조건. 할인 유형 다건조회에 대해서는 할인유형 아이디 (id)와 메모 (memo)를 기반으로 검색 가능합니다. 검색 로직은 %like% 검색입니다.

        \- keyword.memo string \
        메모 값에 대한 검색. 해당 검색으로 진행시 id 검색을 추가할 수 없습니다.

        \- keyword.id string \
        아이디 값에 대한 검색. 해당 검색으로 진행시 메모 검색을 추가할 수 없습니다.

        \- keyword.all string \
        메모 및 아이디 값에 대한 검색. 해당 검색으로 진행시 메모 및 아이디 검색을 추가할 수 없습니다.

    </td>

  </tr>
</table>

---

</div>
<div>

**Request**

```shell
curl -X GET https://api.portone.com/v2/platform/discount-shares/numbered-pages \
     -u {api_key} \
     -d 'page[size]=5' \
     -d 'filter[includeDeleted]=true' \
     -d 'filter[keyword[memo]]=쿠폰'
```

**Response**

```json
[
  {
    "id": "coupon_1",
    "partnerShareRate": 100000000,
    "memo": "파트너 fw23 브랜드 쿠폰",
    "isDeleted": false
  },
  {
    "id": "coupon_2",
    "partnerShareRate": 500000000,
    "memo": "파트너 ss23 브랜드 쿠폰",
    "isDeleted": false
  } // ...
]
```

</div>
</div>

---

### 할인 유형 수정

<div class="gap-4 md:grid grid-cols-2">
<div>

Parameters

**partnerShareRate** optional 기본값은 0

할인 분담율. 10^-9처리 값입니다. 예) 10% = 100000000
정

---

**memo** optional

할인 유형 내부 메모. 예) 파트너 브랜드 쿠폰

---

**applyAt** Date optional 기본값은 api 호출일

해당 업데이트가 적용되길 원하는 시점. 정산시작일 기준으로 적용날짜를 지정할 수 있다. 즉 **applyAt** 이 2023-03-01이라면 settlementStartDate > 2023-03-01인 transfer_api부터 해당 업데이트된 계약정보가 적용됩니다.

</div>
<div>

**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/discount-shares/{id} \
     -u {api_key} \
     -d 'memo=deprecated'
```

**Response**

```json
{
  "id": "coupon_1",
  "partnerShareRate": 100000000,
  "memo": "deprecated",
  "isDeleted": false
}
```

\- **applyAt** 이 미래시점이라면 해당 업데이트 api의 response 값은 변경되기 전 현재 시점의 정보로 업데이트 됩니다.

</div>
</div>

---

### 할인 유형 삭제

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

None

</div>
<div>

**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/discount-shares/{id} \
     -u {api_key}
```

**Response**

```json
{
  "id": "coupon_1",
  "partnerShareRate": 100000000,
  "memo": "deprecated",
  "isDeleted": true
}
```

</div>
</div>

---

## 추가 수수료

<div class="gap-4 md:grid grid-cols-2">
<div>

`추가 수수료` 객체는 가맹점의 주문건에 대해서 단순 중개수수료에 더불어 추가로 부여되는 서비스에대한 수수료 입니다. 대표적인 사용 예시로 풀필먼트 수수료, 로켓배송 수수료, 마케팅채널 수수료등이 있습니다.

</div>
<div>

**Endpoints**

```text
POST /platform/additional-fees
GET /platform/additional-fees/{id}
GET /platform/additional-fees/numbered-pages
POST /platform/additional-fees/{id}
DELETE /platform/additional-fees/{id}
```

</div>
</div>

---

### 추가 수수료 객체

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameter**

**id** string

추가수수료의 고유 아이디

---

**fee** dictionary

추가 수수료 정보를 보여주는 fee attribute

<table>
  <tr>
    <td>

      additionalFees.**type enum**

      정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’

    </td>

  </tr>
  <tr>
    <td>

      additionalFees.**amount int64**

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

      additionalFees.**rate int64**

      정률일경우 백분율로 적용된다. 백분율로써 소수점 첫째자리 까지 가능하다

    </td>

  </tr>
</table>

---

**memo** string

추가 수수료 내부 구분을 위한 내부 메모

---

**vatPayer** enum

해당 계약의 중개수수료에 대해서 부가세 포함 여부.
값: PARTNER, MERCHANT

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

**isDeleted** boolean

삭제 여부. 파트너 정산의 객체들에 대해서 삭제는 soft delete임을 참고해 주세요! 이는 삭제시 해당 삭제된 객체와 동일한 아이디를 발급할경우 새롭게 생성된 객체가 overwrite 합니다.

---

</div>
<div>

**Response**

```json
{
  "id": "kakao_channel_1",
  "fee": {
    "type": "fixedRate",
    "rate": 50000000 // 5%
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": false,
  "vatPayer": "PARTNER"
}
```

</div>
</div>

---

### 추가 수수료 생성

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**id** required

추가수수료의 고유 아이디

---

**fee** required

추가 수수료 정보를 보여주는 fee attribute

<table>
  <tr>
    <td>

      additionalFees.**type enum**

      정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’

    </td>

  </tr>
  <tr>
    <td>

      additionalFees.**amount int64**

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

      additionalFees.**rate int64**

      정률일경우 백분율로 적용된다. 백분율로써 소수점 첫째자리 까지 가능하다

    </td>

  </tr>
</table>

---

**memo** optional

추가 수수료 내부 구분을 위한 내부 메모

---

**vatPayer** optional 기본값은 PARTNER

부가세 부담여부

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

</div>
<div>

**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/additional-fees/ \
     -u {api_key} \
     -d 'id=kakao_channel_1' \
     -d 'fee[type]=fixedRate' \
     -d 'fee[rate]=50000000' \
     -d 'memo=카카오 마케팅 채널 수수료'
```

**Response**

추가 수수료 객체가 반환됩니다.

```json
{
  "id": "kakao_channel_1",
  "fee": {
    "type": "fixedRate",
    "rate": 50000000 // 5%
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": false,
  "vatPayer": "PARTNER"
}
```

</div>
</div>
---

### 추가 수수료 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

None

</div>
<div>

**Request**

```bash
curl -X GET https://api.portone.com/v2/platform/additional-fees/{id} \
     -u {api_key}
```

**Response**

추가 수수료 객체가 반환됩니다.

```json
{
  "id": "transfer_id",
  "partner": {
    "id": "lecturer_1",
    "name": "파이썬 강사",
    "email": "python@platform.com",
    "businessRegistrationNumber": "",
    "account": {
      "bank": "신한은행",
      "currency": "KRW",
      "number": "110-123-456789",
      "holder": "파이썬 강사",
      "status": "APPROVED"
    },
    "status": "APPROVED",
    "defaultContractId": "lecture_contract_1",
    "memo": "컴싸 강사",
    "tags": ["코딩"],
    "isHidden": false,
    "appliedAt": "2023-01-16T08:24:18.178Z"
  },
  "type": "ORDER",
  "status": "SETTLED",
  "memo": "",
  "settlementDate": "2023-01-31",
  "currency": "KRW",
  "payoutId": "payout-id",
  "contract": {
    "id": "lectur_contract_1",
    "memo": "",
    "platformFee": {
      "rate": 100000000
    },
    "settlementCycle": {
      "lagDays": 3,
      "datePolicy": "CALENDAR_DAY",
      "method": { "dayOfMonth": [31] }
    },
    "vatPayer": "PARTNER",
    "isHidden": false,
    "appliedAt": "2023-06-16T08:21:27.949Z"
  },
  "settlementType": "PAYMENT", // or CANCEL
  "payment": {
    /* value: PORTONE, EXTERNAL */
    "source": "PORTONE",
    "paymentId": "merchant_uid_1",
    "storeId": "lectureplatform1",
    "channelKey": "channel-key-3b37819a-1c72-4deb-a245-8c810af5403d",
    "orderName": "",
    "paymentMethod": "CARD",
    "paidAt": "2023-06-16T08:21:27.949Z",
    "easyPayReceipt": {
      "easyPayProvider": "SAMSUNGPAY",
      "method": "CARD",
      "amount": 9000,
      "discount": 0
    },
    "currency": "KRW"
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": false,
  "vatPayer": "PARTNER"
}
```

</div>
</div>

---

### 추가 수수료 다건 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameter**

Parameters

**page** optional

페이지 기반의 다건 조회 갯수 조건

page attributes

<table>
  <tr>
    <td>

      page.**number** optional 기본값은 1

      검색 결과에대한 페이징. size에 따라 offset 값이라고 생각하면 됩니다.

    </td>

  </tr>
  <tr>
    <td>

      page.**size** optional 기본값은 10

      각 page당 조회될 할인 유형 객체 갯수.

    </td>

  </tr>
</table>

---

**filter** required

검색 조건

filter attributes

<table>
  <tr>
    <td>

      filter.**includeDeleted** boolean optional 기본값은 false

    </td>

  </tr>
  <tr>
    <td>

      filter.**additionalFeesIds** optional

      추가 수수료 객체 고유 아이디로 구성된 리스트

    </td>

  </tr>
  <tr>
    <td>

      filter.**vatApplied** boolean

      부가세 적용 여부 검색

    </td>

  </tr>
</table>

---

</div>
<div>

**Request**

```bash
curl -X GET https://api.portone.com/v2/platform/additional-fees/numbered-pages \
     -u {api_key} \
     -d 'page[size]=5' \
     -d 'filter[vatApplied]=true'
```

```json
[
  {
    "id": "kakao_channel_1",
    "fee": {
      "type": "fixedRate",
      "rate": 50000000 // 5%
    },
    "memo": "카카오 마케팅 채널 수수료",
    "isDeleted": false,
    "vatPayer": "PARTNER"
  },
  {
    "id": "insta_channel_1",
    "fee": {
      "type": "fixedRate",
      "rate": 70000000 //7%
    },
    "memo": "인스타 마케팅 채널 수수료",
    "isDeleted": false,
    "vatPayer": "PARTNER"
  } // ...
]
```

</div>
</div>

---

### 추가 수수료 수정

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**id** required

추가수수료 고유 아이디

---

**fee** required

추가 수수료 정보를 보여주는 fee attribute

<table>
  <tr>
    <td>

      additionalFees.**type enum**

      정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’

    </td>

  </tr>
  <tr>
    <td>

      additionalFees.**amount int64**

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

      additionalFees.**rate int64**

      정률일 경우 백분율로 적용된다. 백분율로써 소수점 첫째 자리까지 가능하다

    </td>

  </tr>
</table>

---

**memo** optional

추가 수수료 내부 구분을 위한 내부 메모

---

**vatPayer** optional 기본값은 PARTNER

부가세 부담여부

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

**applyAt** Date optional 기본값은 api 호출일

해당 업데이트가 적용되길 원하는 시점. 정산시작일 기준으로 적용날짜를 지정할 수 있다. 즉 **applyAt** 이 2023-03-01이라면 settlementStartDate > 2023-03-01인 transfer_api부터 해당 업데이트된 계약정보가 적용됩니다.

---

</div>
<div>

**Request**

```shell
curl -X PATCH https://api.portone.com/v2/platform/additional-fees/{id} \
     -u {api_key} \
     -d 'fee[rate]=700000000' \
     -d 'applyAt=2023-06-01'
```

**Resposne**

```json
{
  "id": "transfer_id",
  "partner": {
    "id": "lecturer_1",
    "name": "파이썬 강사",
    "email": "python@platform.com",
    "businessRegistrationNumber": "",
    "account": {
      "bank": "신한은행",
      "currency": "KRW",
      "number": "110-123-456789",
      "holder": "파이썬 강사",
      "status": "APPROVED"
    },
    "status": "APPROVED",
    "defaultContractId": "lecture_contract_1",
    "memo": "컴싸 강사",
    "tags": ["코딩"],
    "isHidden": false,
    "appliedAt": "2023-01-16T08:24:18.178Z"
  },
  "type": "ORDER",
  "status": "SETTLED",
  "memo": "",
  "settlementDate": "2023-01-31",
  "currency": "KRW",
  "payoutId": "payout-id",
  "contract": {
    "id": "lectur_contract_1",
    "memo": "",
    "platformFee": {
      "rate": 100000000
    },
    "settlementCycle": {
      "lagDays": 3,
      "datePolicy": "CALENDAR_DAY",
      "method": { "dayOfMonth": [31] }
    },
    "vatPayer": "PARTNER",
    "isHidden": false,
    "appliedAt": "2023-06-16T08:21:27.949Z"
  },
  "settlementType": "PAYMENT", // or CANCEL
  "payment": {
    /* value: PORTONE, EXTERNAL */
    "source": "PORTONE",
    "paymentId": "merchant_uid_1",
    "storeId": "lectureplatform1",
    "channelKey": "channel-key-3b37819a-1c72-4deb-a245-8c810af5403d",
    "orderName": "",
    "paymentMethod": "CARD",
    "paidAt": "2023-06-16T08:21:27.949Z",
    "easyPayReceipt": {
      "easyPayProvider": "SAMSUNGPAY",
      "method": "CARD",
      "amount": 9000,
      "discount": 0
    },
    "currency": "KRW"
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": false,
  "vatPayer": "PARTNER"
}
```

\- **applyAt** 이 미래시점이라면 해당 업데이트 api의 response 값은 변경되기 전 현재 시점의 정보로 업데이트 됩니다.

</div>
</div>

---

### 추가 수수료 삭제

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

None

</div>
<div>

**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/additional-fees/{id} \
     -u {api_key}
```

**Response**

```json
{
  "id": "kakao_channel_1",
  "fee": {
    "type": "fixedRate",
    "rate": 50000000 // 5%
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": true,
  "vatPayer": "PARTNER"
}
```

</div>
</div>

---

## 파트너 정산 설정 (In Progress)

<div class="gap-4 md:grid grid-cols-2">
<div>

`파트너 정산 설정` 객체는 가맹점이 파트너에게 정산해줄때 적용될 기본적인 설정을 의미합니다. 정산 계산시 적용될 소수점 처리방식, 각 항목 (중개 수수료, 추가 수수료 ,할인 분담, 결제수수료 (TBA)) 에 대한 구체적 계산 수식을 설정 할 수 있으며 추가로 결제(PG)수수료 파트너 부담여부를 설정 할 수 있습니다.

파트너 정산을 사용하는 가맹점당 단일객체가 발급되며 삭제가 불가능 합니다.

</div>
<div>

**Endpoints**

```text
POST /platform/platform-merchant
GET /platform/platform-merchant
POST /platform/additional-fees/platform-merchant
```

</div>
</div>

---

### 파트너 정산 설정 객체

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameter**

**merchant_id** string

포트원이 부여한 가맹점 고유 아이디

---

**roundType** enum

정산식 계산시 적용될 소수점 처리 방식. 내림, 올림, 반올림이 있다. 각각의 수수료와 부가세 및 할인 분담금액을 계산할때 적용된다.

- OFF: 반올림
- DOWN: 내림
- UP: 올림

---

**channelFeePayer** enum

현재는 지원하지 않는 기능이나, PG사가 가맹점에게 부여하는 결제 수수료를 파트너에게 부담할 경우 해당 값을 파트너 (PARTNER)로 지정 하면 됩니다. 그럴경우 정산계산을 위해 사용하시는 pg사의 수수료를 계산하여 차감합니다.

- PARTNER: 결제수수료 파트너 부담일경우
- MERCHANT: 결제수수료를 가맹점이 부담할 경우

---

**settlementFormula** dicitionary

전체 정산과 각 수수료 및 할인분담금을 계산하는데 적용되는 수식에 대한 값입니다. 다만 현재는 해당 값은 `관리자콘솔 > 파트너 정산 > 계약관리 > 수식` 에서 확인 및 수정하실 수 있으십니다.

<table>
  <tr>
    <td>
      <div class="text-sm text-gray-500">

        **settlementFormula.platformFee**\
        중개수수료 수식

      </div>
    </td>

  </tr>
  <tr>
    <td>
      <div class="text-sm text-gray-500">

        **settlementFormula.channelFee (TBA)**\
        결제수수료 수식

      </div>
    </td>

  </tr>
  <tr>
    <td>
      <div class="text-sm text-gray-500">

        **settlementFormula.discountShare**\
        할인분담금 수식

      </div>
    </td>

  </tr>
  <tr>
    <td>
      <div class="text-sm text-gray-500">

        **settlementFormula.additionalFee**\
        추가 수수료 수식

      </div>
    </td>

  </tr>
</table>

---

</div>
</div>

---
