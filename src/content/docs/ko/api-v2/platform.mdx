---
title: 파트너 정산 API - alpha 버전
description: 파트너 정산에 관련된 API 를 확인할 수 있습니다.
---

import * as prose from "~/components/prose";
export const components = prose;

import Details from "~/components/gitbook/Details.astro";

## 서문

안녕하세요. 포트원 PO 김준일입니다.

미팅을 통해 소개드린 파트너 정산 Public API의 스펙을 전달드리려고 합니다.

포트원이 제공하는 관리자 콘솔을 통해 정산 업무를 확인하고자 한다면, **정산** 부분을 참고해주시고, 귀사의 자체 백오피스에 통합하길 원하신다면 전체 API 스펙을 검토해주시기 바랍니다.

또한, 대량 이체와 상품정보를 활용한 정산 등록과 같은 API는 곧 업데이트될 예정입니다.

개발이 완료되기 전에 알파 버전으로 제공드리며, 개발이 완료되면 동일한 문서 url에 업데이트 되며 테스트 해볼 수 있는 페이지를 제공해드리겠습니다.

더 궁금한 사항이 있으시거나 추가적인 도움이 필요하시면 언제든지 연락주세요.

---

## 파트너

<div class="gap-4 md:grid grid-cols-2">
<div>

`파트너` 객체는 가맹점이 정산해줘야할 대상입니다.

기본 사업자 정보와 정산정보, 그리고 적용될 계약의 정보를 등록 및 관리할 수 있습니다.

</div>
<div>

#### Endpoints

```text
POST platform/partners
POST platform/partners/batch
GET platform/partners/{id}
GET platform/partners
POST platform/partners/{id}
DELETE platform/partners/{id}
```

</div>
</div>

---

### 파트너 객체

<div class="gap-4 md:grid grid-cols-2">
<div>

#### Attributes

**id** string

파트너 고유 아이디

---

**name** string

파트너 법인명 혹은 이름

---

**email** string

파트너 이메일

---

**businessRegistrationNumber** string

파트너 사업자번호. 개인 혹은 법인 사업자일때만 존재합니다.

---

**account** dictionary

정산 계좌 Attribute

<table name = "bank_account">
  <tr>
    <td>
    
    account.**bank** enum or string

    은행 이름.

    \- currnecy가 KRW일시 증권사가 제외된 한국 은행 코드별상의 은행값 enum 하단 참고. 해당 은행값 외의 은행은 에러 처리\
    \- currency 가 KRW가 아닐때 해외 은행 string값으로 입력 가능

    </td>

  </tr>
  <tr>
    <td>

    account.**currency** enum

    화페로써 현재로썬 KRW, JPY, USD만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

    account.**number** string

    계좌번호. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>
  <tr>
    <td>

    account.**holder** string

    예금주. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>

</table>

</div>
<div>

#### Response

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "abc@gmail.com",
  "businessRegistrationNumber": null,
  "account": {
    "bank": "신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "Verified"
  },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tags": ["개발", "강사"],
  "isDeleted": false,
  "updatedAt": "2023-05-07"
}
```

</div>
</div>

---

### 파트너 생성

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**id** optional

파트너에 부여하는 고유 아이디. 가맹점 서버에 등록된 파트너지칭 아이디와 동일해야 합니다. 따로 없다면 포트원이 발급해 드립니다.

---

**name** required

파트너를 지칭하는 사업자명 및 이름

---

**email** optional

파트너 이메일

---

**businessRegistrationNumber** optional

파트너 사업자번호. 검증하지는 않음. 번호 기호 둘다 가능

---

**account** required

account attirbute

<table name = "bank_account">
  <tr>
    <td>
    
    account.**bank** enum or string

    은행 이름.

    \- currnecy가 KRW일시 증권사가 제외된 한국 은행 코드별상의 은행값 enum 하단 참고. 해당 은행값 외의 은행은 에러 처리\
    \- currency 가 KRW가 아닐때 해외 은행 string값으로 입력 가능

    </td>

  </tr>
  <tr>
    <td>

    account.**currency** enum

    화페로써 현재로썬 KRW, JPY, USD만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

    account.**number** string

    계좌번호. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>
  <tr>
    <td>

    account.**holder** string

    예금주. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>

</table>

---

**defaultContractId** required

이미 존재하는 계약객체의 아이디를 등록해야합니다.

---

**memo** optional

256자까지 가능합니다.

---

**tag** optional

최대 10개까지 가능합니다.

---

</div>

<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/partner \
     -u {api_key} \
     -d 'id=lecturer_1' \
     -d 'name=파이선 강사 홍길동' \
     -d 'email=abc@gmail.com' \
     -d 'account={"bank": "신한", "currency": "KRW", "number": "123-45-6789"}' \
     -d 'defaultContractId=contract_1' \
     -d 'memo=파이선 일타 강사, rs 3%' \
     -d 'tag[]=개발' \
     -d 'tag[]=강사'
```

**Response**

파트너 객체가 반환됩니다.

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "abc@gmail.com",
  "businessRegistrationNumber": null
  "account":{
    "bank":"신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "Verified",
    },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발","강사"],
  "isDeleted": false,
  "updatedAt": "2023-05-07"
}
```

</div>
</div>

---

### 파트너 조회

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**id** required

조회하고 싶은 파트너 고유 아이디

---

</div>
<div>
**Request**

```shell
curl -X GET https://api.portone.com/v2/platform/partner/lecturer_1 \
     -u {api_key}
```

**Response**

파트너 객체가 반환됩니다.

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "abc@gmail.com",
  "businessRegistrationNumber": null
  "account":{
    "bank":"신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "Verified",
    },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발","강사"],
  "isDeleted": false,
  "updatedAt": "2023-05-07"
}
```

</div>
</div>
---

### 파트너 다건 조회

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

---

**includeDeleted** optional

삭제한 파트너까지 조회하고싶은 경우

---

**pageRequested** optional

---

**filter** dictionary

다건 조회시 적용하고 싶은 필터 값.

<table name="bank_account">
  <tr>
    <td>filter.**includeDeleted** boolean optional 기본값은 false </td>
  </tr>
  <tr>
    <td>
      filter.**tags** list of string optional 파트너에게 부여한 태그 리스트 값.
    </td>
  </tr>
  <tr>
    <td>
      filter.**option** one of dictionary 검색 조건. 조건중 한 값을 지정하여
      %like% 검색한다. 
      \- option.id 파트너 아이디 \
      \- option.name 파트너 이름 \
      \-option.email 파트너 이메일 \
      \- option.businessRegistrationNumber 파트너 사업자 번호 \
      \- option.defaultContractId 파트너 기본 계약 아이디 \
      \-option.memo 파트너 메모 \
      \- option.accountBank 파트너 계좌 은행 \
      \-option.accountCurrency 파트너 계좌 통화 \
      \- option.accountNumber 파트너 계좌 번호\
      \- option.accountHolder 파트너 계좌 예금주

    </td>

  </tr>
</table>

---

  </div>
  <div>
  **Request**

```shell
curl -X POST https://api.portone.com/v2/platform/partners \
     -u {api_key} \
     -d 'filter[option[memo]]=파이선'


```

**Response**

여러 파트너 객체들이 리스트 형태로 반환됩니다.

```json
[{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "abc@gmail.com",
  "businessRegistrationNumber": null
  "account":{
    "bank":"신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "Verified",
    },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발","강사"],
  "isDeleted": false,
  "updatedAt": "2023-05-07"
},...
]
```

  </div>
</div>

---

### 파트너 수정

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

**id** required

수정하고 싶은 파트너의 아이디

---

**name** optional

파트너를 지칭하는 사업자명 및 이름

---

**email** optional

파트너 이메일

---

**businessRegistrationNumber** optional

파트너 사업자번호. 검증하지는 않음. 번호 기호 둘다 가능

---

**account** optional

account attirbute

<table name = "bank_account">
  <tr>
    <td>
    
    account.**bank** enum or string

    은행 이름.

    \- currnecy가 KRW일시 증권사가 제외된 한국 은행 코드별상의 은행값 enum 하단 참고. 해당 은행값 외의 은행은 에러 처리\
    \- currency 가 KRW가 아닐때 해외 은행 string값으로 입력 가능

    </td>

  </tr>
  <tr>
    <td>

    account.**currency** enum

    화페로써 현재로썬 KRW, JPY, USD만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

    account.**number** string

    계좌번호. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>
  <tr>
    <td>

    account.**holder** string

    예금주. currency가 krw일경우 따로 예금주 조회 api를 통해 검증한다. 그 외의 화폐일 경우 따로 검증하지는 않는다.

    </td>

  </tr>

</table>

---

**defaultContract** required dictionary

defaultContract attribute에 바꾸고 싶은 계약 아이디와 적용시점을 지정합니다. 적용시점에 지정된 시점을 기준으로 정산시작일이 이후에 있는 정산객체들에게 적용됩니다.

<table name="bank_account">
  <tr>
    <td>
      defaultContract.**defaultContractId** string 파트너에게 적용될 새로운 계약
      아이디
    </td>
  </tr>
  <tr>
    <td>defaultContract.**applyAt** string 파트너의 기본계약 변경 적용시점.</td>
  </tr>
</table>

---

**memo** optional

256자까지 가능합니다.

---

**tag** optional

최대 10개까지 가능합니다.

---

</div>
<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/partner/lecturer_1 \
     -u {api_key} \
     -d 'email=new@gmail.com' \
     -d 'account={"bank": "우리", "currency": "KRW", "number": "987-65-4321"}' \
     -d 'defaultContract[defaultContractId]=contract_1' \
     -d 'defaultContract[applied_at]=2022-03-01'
```

**Response**

업데이트 된 파트너 객체가 반환됩니다.

```json
[{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "new@gmail.com",
  "businessRegistrationNumber": null
  "account":{
    "bank":"우리",
    "currency": "KRW",
    "number": "987-65-4321",
    "holder": "홍길동",
    "status": "Verified",
    },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발","강사"],
  "isDeleted": false,
  "updatedAt": "2023-05-07"
},...
]
```

---

\- 예금주 조회 검증을통해 계좌가 유효하지 않을경우 에러를 반환합니다

    </div>

</div>

---

### 파트너 삭제

<div class="gap-4 md:grid grid-cols-2">
<div>

**Parameters**

**id** required
삭제하고 싶은 파트너의 아이디

---

</div>
<div>
**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/partner/lecturer_1 \
     -u {api_key}
```

**Response**

**isDeleted** 가 true인 파트너 객체가 반환됩니다.

```json
{
  "id": "lecturer_1",
  "name": "파이선 강사 홍길동",
  "email": "abc@gmail.com",
  "businessRegistrationNumber": null
  "account":{
    "bank":"신한",
    "currency": "KRW",
    "number": "123-45-6789",
    "holder": "홍길동",
    "status": "Verified",
    },
  "defaultContractId": "contract_1",
  "memo": "파이선 일타 강사, rs 3%",
  "tag": ["개발","강사"],
  "isDeleted": true,
  "updatedAt": "2023-05-07"
}
```

---

</div>
</div>

---

## 계약

<div class="gap-4 md:grid grid-cols-2">
<div>
`계약` 객체는 가맹점이 파트너에게 정산해줄 대금과 정산일을 계산하는데 적용되는 정보입니다.

가맹점의 플랫폼에서 재화 및 서비스를 판매하는데에 대한 중개수수료정보와 판매금에 대한 정산을 언제 해주는지 알려주는 정산일로 구성되어 있습니다.

</div>
<div>
**Endpoints**

```text
POST platform/contract
GET platform/contract/{id}
GET platform/contracts
POST platform/contract/{id}
DELETE platform/contract/{id}
```

</div>
</div>

---

### 계약 객체

<div class="gap-4 md:grid grid-cols-2">
<div>
Attributes

**id** string
계약객체의 고유 아이디

---

**memo** string

계약객체 내부 표기를 위한 메모

---

**platformFee** dictionary

중개수수료. 기본 **Fee** attribute 을 사용한다.

<table>
  <tr>
    <td>

      platformFee.**type** enum

      정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’
    </td>

  </tr>
  <tr>
    <td>

      platformFee.**amount** int64

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.
    </td>

  </tr>
  <tr>
    <td>

      platformFee.**rate** int64

      정률일 경우 10^-9표기. 즉 10% → 100000000 으로 입력.
    </td>

  </tr>
</table>

---

**settlementCycle** dictionary

정산주기 Attribute. 지체일, 정산일, 기준일로 구성되어있다. 해당 요소들의 조합으로 정산일을 계산한다.

<table name="settlementCycle">
  <tr>
    <td>

      settlementCycle.**lagDays** int64

      지체일(d+n의 n).정산시작일(통상주문완료일) 로 부터 더해진다음 날짜로부터 가장 가까운 날에 정산이 된다. 최소 1 최대 10 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**method** enum

      정산주기 관련되서 매일, 주에 n회, 달에 n회, 특정 분기 혹은 지정된 날짜에 정산을 할수 있도록 정산주기의 기간별 종류를 정할 수 있다. 값으론 daily, weekly, monthly, manualDates 가 있습니다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**daily** boolean

      method 가 daily일 경우에는 매일 파트너에게 정산금이 지급된다는 경우
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**weekly** int64

      method 가 weekly일 경우에는 주에 n회 정산이 된다는 경우. 최소 1 최대 4 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**monthly** int64

      method 가 monthly일 경우에는 달에 n회 정산이 된다는 경우. 최소 1 최대 2 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**manualDates** list

      method 가 manualDates일 경우에는 특정 날짜에 정산이 된다는 경우. 최소 1 최대 10 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**datePolicy** enum

     기준일이며 정산일 계산시 공휴일을 고려하기 위함이다. 값은 달력일, 전 영업일, 후 영업일 이렇게 3가지가 있다.
    값: CALENDAR_DAY, HOLIDAY_BEFORE, HOLIDAY_AFTER
    </td>

  </tr>
</table>
- 정산주기 값 설정 예시

```javascript
settlementCycle = {
  lay_days: 3,
  method: 'monthly',
  monthly: [15, 31],
  datePolicy: 'HOLIDAY_BEFORE',
};
```

case 1: 10일 주문완료 (settlementStartDate)

- d + 3일 = 13일
- 13일의 그다음 정산일 = 15일
- if 15일이 영업일이라면 정산일 = 15일
- elif 15일이 영업일이 아니라면 i.e. 토요일 이라면 정산일 = 14일

case 2: 13일 주문완료

- d + 3일 = 16일
- 16일의 그다음 정산일 = 31일
- if 31일이 영업일이라면 정산일 = 31일
- elif 31일이 영업일이 아니라면 i.e. 토요일 이라면 정산일 = 30일

---

**vatPayer** enum

해당 계약의 중개수수료에 대해서 부가세 포함 여부.
값: PARTNER, MERCHANT

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

**isDeleted** boolean

계약 객체 삭제 여부. 포트원 내부에서는 soft delete이므로

---

</div>
<div>
**Response (월별 정산)**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "type": "fixedRate",
    "rate": "100000000"
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "monthly",
    "monthly": [15, 31],
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isDeleted": false
}
```

**Response (일별 정산)**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "type": "fixedRate",
    "rate": "10"
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "daily",
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isDeleted": false
}
```

**Response (주별 정산)**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "type": "fixedRate",
    "rate": "10"
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "weekly",
    "weekly": ["FRI"],
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isDeleted": false
}
```

**Response (월-일 정산)**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "type": "fixedRate",
    "rate": "10"
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "manualDates",
    "manualDates": ["03-31", "06-30", "09-30", "12-31"],
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isDeleted": false
}
```

</div>
</div>

---

### 계약 생성

<div class="gap-4 md:grid grid-cols-2">
<div>
Parameters

**id** optional

계약객체에 부여하는 고유 아이디. 전달하지 않을경우 response에서 포트원이 임의로 발급해 드립니다.

---

**platformFee** required

중개 수수료

<table>
  <tr>
    <td>

      platformFee.**type** enum

      정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’
    </td>

  </tr>
  <tr>
    <td>

      platformFee.**amount** int64

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.
    </td>

  </tr>
  <tr>
    <td>

      platformFee.**rate** int64

      정률일 경우 10^-9표기. 즉 10% → 100000000 으로 입력.
    </td>

  </tr>
</table>

---

**settlementCycle** required
정산주기

<table name="settlementCycle">
  <tr>
    <td>

      settlementCycle.**lagDays** int64

      지체일(d+n의 n).정산시작일(통상주문완료일) 로 부터 더해진다음 날짜로부터 가장 가까운 날에 정산이 된다. 최소 1 최대 10 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**method** enum

      정산주기 관련되서 매일, 주에 n회, 달에 n회, 특정 분기 혹은 지정된 날짜에 정산을 할수 있도록 정산주기의 기간별 종류를 정할 수 있다. 값으론 daily, weekly, monthly, manualDates 가 있습니다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**daily** boolean

      method 가 daily일 경우에는 매일 파트너에게 정산금이 지급된다는 경우
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**weekly** int64

      method 가 weekly일 경우에는 주에 n회 정산이 된다는 경우. 최소 1 최대 4 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**monthly** int64

      method 가 monthly일 경우에는 달에 n회 정산이 된다는 경우. 최소 1 최대 2 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**manualDates** list

      method 가 manualDates일 경우에는 특정 날짜에 정산이 된다는 경우. 최소 1 최대 10 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**datePolicy** enum

     기준일이며 정산일 계산시 공휴일을 고려하기 위함이다. 값은 달력일, 전 영업일, 후 영업일 이렇게 3가지가 있다.
    값: CALENDAR_DAY, HOLIDAY_BEFORE, HOLIDAY_AFTER
    </td>

  </tr>
</table>

---

**vatPayer** optional

부가세 여부

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

**memo** optional

계약객체 내부 표기를 위한 메모

---

</div>
<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/contract \
     -u {api_key} \
     -d 'id=contract_1' \
     -d 'platformFee[type]=fixedRate' \
     -d 'platformFee[rate]=100000000' \
     -d 'settlementCycle[lagDays]=3' \
     -d 'settlementCycle[method]=monthly' \
     -d 'settlementCycle[monthly]=[15,31]' \
     -d 'settlementCycle[datePolicy]=HOLIDAY_BEFORE' \
     -d 'vatPayer=PARTNER' \
     -d 'memo=셀러 기본 계약 1'

```

**Response**

생성된 계약 객체가 반환됩니다.

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "type": "fixedRate",
    "rate": 100000000
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "monthly",
    "monthly": [15, 31],
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isDeleted": false
}
```

</div>
</div>

---

### 계약 조회

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

None

</div>
<div>
**Request**

```shell
curl https://api.portone.com/v2/platform/contract/{id}\
     -u {api_key}\
```

**Response**

조회한 아이디의 계약객체가 반환됩니다.

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "type": "fixedRate",
    "rate": 100000000
  },
  "settlementCycle": {
    "lagDays": 3,
    "method": "monthly",
    "monthly": [15, 31],
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isDeleted": false
}
```

</div>
</div>
---

### 계약 수정

<div class="gap-4 md:grid grid-cols-2">
<div>
Parameters

**applyAt** Date optional 기본값은 api 호출일

해당 업데이트가 적용되길 원하는 시점. 정산시작일 기준으로 적용날짜를 지정할 수 있다. 즉 **applyAt** 이 2023-03-01이라면 settlementStartDate > 2023-03-01인 transfer_api부터 해당 업데이트된 계약정보가 적용됩니다.

---

**platformFee** optional
중개 수수료

<table>
  <tr>
    <td>

      platformFee.**type** enum

      정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’
    </td>

  </tr>
  <tr>
    <td>

      platformFee.**amount** int64

      정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.
    </td>

  </tr>
  <tr>
    <td>

      platformFee.**rate** int64

      정률일 경우 10^-9표기. 즉 10% → 100000000 으로 입력.
    </td>

  </tr>
</table>

---

**settlementCycle** optional

정산주기

<table name="settlementCycle">
  <tr>
    <td>

      settlementCycle.**lagDays** int64

      지체일(d+n의 n).정산시작일(통상주문완료일) 로 부터 더해진다음 날짜로부터 가장 가까운 날에 정산이 된다. 최소 1 최대 10 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**method** enum

      정산주기 관련되서 매일, 주에 n회, 달에 n회, 특정 분기 혹은 지정된 날짜에 정산을 할수 있도록 정산주기의 기간별 종류를 정할 수 있다. 값으론 daily, weekly, monthly, manualDates 가 있습니다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**daily** boolean

      method 가 daily일 경우에는 매일 파트너에게 정산금이 지급된다는 경우
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**weekly** int64

      method 가 weekly일 경우에는 주에 n회 정산이 된다는 경우. 최소 1 최대 4 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**monthly** int64

      method 가 monthly일 경우에는 달에 n회 정산이 된다는 경우. 최소 1 최대 2 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**manualDates** list

      method 가 manualDates일 경우에는 특정 날짜에 정산이 된다는 경우. 최소 1 최대 10 까지 지정할 수 있다.
    </td>

  </tr>
  <tr>
    <td>

      settlementCycle.**datePolicy** enum

     기준일이며 정산일 계산시 공휴일을 고려하기 위함이다. 값은 달력일, 전 영업일, 후 영업일 이렇게 3가지가 있다.
    값: CALENDAR_DAY, HOLIDAY_BEFORE, HOLIDAY_AFTER
    </td>

  </tr>
</table>

---

**memo** optional

계약객체 내부 표기를 위한 메모

---

</div>
<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/contract/{id} \
     -u {api_key} \
     -d 'settlementCycle[lagDays]=2' \
     -d 'settlementCycle[method]=weekly' \
     -d 'settlementCycle[monthly]=[FRI]'

```

**Response**

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "type": "fixedRate",
    "rate": 100000000
  },
  "settlementCycle": {
    "lagDays": 2,
    "method": "weekly",
    "monthly": ["Fri"],
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isDeleted": false
}
```

\- **applyAt** 이 미래시점이라면 해당 업데이트 api의 response 값은 변경되기 전 현재 시점의 정보로 업데이트 됩니다.

  </div>
</div>

---

### 계약 삭제

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameter**

None

</div>
<div>
**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/contract/{id} \
     -u {api_key}

```

**Response**

**isDeleted** true인 계약 객체가 반환됩니다.

```json
{
  "id": "contract_1",
  "memo": "셀러 기본 계약 1",
  "platformFee": {
    "type": "fixedRate",
    "rate": 100000000
  },
  "settlementCycle": {
    "lagDays": 2,
    "method": "weekly",
    "monthly": ["Fri"],
    "datePolicy": "HOLIDAY_BEFORE"
  },
  "vatPayer": "PARTNER",
  "isDeleted": true
}
```

</div>
</div>

---

## 할인 유형

<div class="gap-4 md:grid grid-cols-2">
<div>
`할인 유형` 객체는 가맹점의 주문건에 대해서 쿠폰 및 포인트와 같은 할인금액이 적용될시 이에대해서 파트너 정산에 할인금과 할인에 따른 파트너와의 분담율을 적용하고자 사용할 수 있는 객체입니다.

할인 유형에 대한 아이디와 메모 그리고 파트너 분담율로 정보 구성이 되어있습니다.

</div>
<div>
**Endpoints**

```text
POST platform/discount-shares
GET platform/discount-shares/{id}
GET platform/discount-shares/numbered-pages
POST platform/discount-shares/{id}
DELETE platform/discount-shares/{id}
```

</div>
</div>
---

### 할인 유형 생성

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

**id** optional

할인 유형 고유아이디. 가맹점 서버에 저장되고 통용되는 아이디로 지정해주세요. 없다면 포트원에서 임의로 발급해드리며 이를 저장해주세요.

---

**partnerShareRate** optional 기본값은 0

할인 분담율. 10^-9처리 값입니다. 예) 10% = 100000000

---

**memo** optional

할인 유형 내부 메모. 예) 파트너 브랜드 쿠폰

</div>
<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/discount-shares \
     -u {api_key} \
     -d 'id=coupon_1' \
     -d 'partnerShareRate=100000000' \
     -d 'memo=파트너 브랜드 쿠폰'

```

**Response**

생성된 할인 유형 객체가 반환됩니다.

```json
{
  "id": "coupon_1",
  "partnerShareRate": 100000000,
  "memo": "파트너 브랜드 쿠폰"
  "isDeleted": false
}
```

</div>
</div>
---

### 할인 유형 조회

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

None

</div>
<div>
**Request**

```shell
curl -X GET https://api.portone.com/v2/platform/discount-shares/{id} \
     -u {api_key}

```

**Response**

조회 대상 할인 유형이 반환됩니다.

```json
{
  "id": "coupon_1",
  "partnerShareRate": 100000000,
  "memo": "파트너 브랜드 쿠폰"
  "isDeleted": false
}
```

</div>
</div>

---

### 할인 유형 다건 조회

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

**page** optional

페이지 기반의 다건 조회 갯수 조건

page attributes

<table name = "bank_account">
  <tr>
    <td>

      page.**number** optional 기본값은 1

     검색 결과에대한 페이징. size에 따라 offset 값이라고 생각하면 됩니다.
    </td>

  </tr>
  <tr>
    <td>

      page.**size** optional 기본값은 10

     각 page당 조회될 할인 유형 객체 갯수.
    </td>

  </tr>
</table>

---

**filter** required

검색 조건

filter attributes

<table name = "bank_account">
  <tr>
    <td>

      filter.**includeDeleted** boolean optional 기본값은 false

     true로 설정시 삭제된 할인 유형 객체도 조회됩니다.
    </td>

  </tr>
  <tr>
    <td>

      filter.**partnerShareRates** list of int64 optional

     파트너 분담율로 구성된 리스트. 해당 리스트에 포함된 분담율과 매칭되는 모든 할인 유형 객체들을 반환한다.
    </td>

  </tr>
  <tr>
    <td>

      filter.**keyword** dictionary optional

     통합검색을 위한 조건. 할인 유형 다건조회에 대해서는 할인유형 아이디 (id)와 메모 (memo)를 기반으로 검색 가능합니다. 검색 로직은 %like% 검색입니다.

        \- keyword.memo string \
        메모 값에대한 검색. 해당 검색으로 진행시 id검색을 추가 할 수 없습니다.

        \- keyword.id string \
        아이디 값에대한 검색. 해당 검색으로 진행시 메모 검색을 추가할 수 없습니다.

        \- keyword.all string \
        메모 및 아이디 값에대한 검색. 해당 검색으로 진행시 메모 및 아이디 검색을 추가할 수 없습니다.
    </td>

  </tr>
</table>

---

</div>
<div>
**Request**

```shell
curl -X GET https://api.portone.com/v2/platform/discount-shares/numbered-pages \
     -u {api_key} \
     -d 'page[size]=5' \
     -d 'filter[includeDeleted]=true' \
     -d 'filter[keyword[memo]]=쿠폰'

```

**Response**

```json
[
  {
    "id": "coupon_1",
    "partnerShareRate": 100000000,
    "memo": "파트너 fw23 브랜드 쿠폰"
    "isDeleted": false
  },
  {
    "id": "coupon_2",
    "partnerShareRate": 500000000,
    "memo": "파트너 ss23 브랜드 쿠폰"
    "isDeleted": false
  }, ...
]
```

</div>
</div>
---
### 할인 유형 수정
<div class="gap-4 md:grid grid-cols-2">
<div>
Parameters

**partnerShareRate** optional 기본값은 0

할인 분담율. 10^-9처리 값입니다. 예) 10% = 100000000
정

---

**memo** optional

할인 유형 내부 메모. 예) 파트너 브랜드 쿠폰

---

**applyAt** Date optional 기본값은 api 호출일

해당 업데이트가 적용되길 원하는 시점. 정산시작일 기준으로 적용날짜를 지정할 수 있다. 즉 **applyAt** 이 2023-03-01이라면 settlementStartDate > 2023-03-01인 transfer_api부터 해당 업데이트된 계약정보가 적용됩니다.

</div>
<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/discount-shares/{id} \
     -u {api_key} \
     -d 'memo=deprecated'

```

**Response**

```json
{
  "id": "coupon_1",
  "partnerShareRate": 100000000,
  "memo": "deprecated"
  "isDeleted": false
}
```

\- **applyAt** 이 미래시점이라면 해당 업데이트 api의 response 값은 변경되기 전 현재 시점의 정보로 업데이트 됩니다.

</div>
</div>
---

### 할인 유형 삭제

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

None

</div>
<div>
**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/discount-shares/{id} \
     -u {api_key}

```

**Response**

```json
{
  "id": "coupon_1",
  "partnerShareRate": 100000000,
  "memo": "deprecated"
  "isDeleted": true
}
```

</div>
</div>
---

## 추가 수수료

<div class="gap-4 md:grid grid-cols-2">
<div>
`추가 수수료` 객체는 가맹점의 주문건에 대해서 단순 중개수수료에 더불어 추가로 부여되는 서비스에대한 수수료 입니다. 대표적인 사용 예시로 풀필먼트 수수료, 로켓배송 수수료, 마케팅채널 수수료등이 있습니다.

</div>
<div>
**Endpoints**

```text
POST platform/additional-fees
GET platform/additional-fees/{id}
GET platform/additional-fees/numbered-pages
POST platform/additional-fees/{id}
DELETE platform/additional-fees/{id}
```

</div>
</div>
---

### 추가 수수료 객체

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameter**

**id** string

추가수수료의 고유 아이디

---

**fee** dictionary

추가 수수료 정보를 보여주는 fee attribute

<table>
  <tr>
    <td>

    additionalFees.**type enum**

    정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’

    </td>

  </tr>
  <tr>
    <td>

    additionalFees.**amount int64**

    정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

    additionalFees.**rate int64**

    정률일경우 백분율로 적용된다. 백분율로써 소수점 첫째자리 까지 가능하다

    </td>

  </tr>
</table>

---

**memo** string

추가 수수료 내부 구분을 위한 내부 메모

---

**vatPayer** enum

해당 계약의 중개수수료에 대해서 부가세 포함 여부.
값: PARTNER, MERCHANT

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

**isDeleted** boolean

삭제 여부. 파트너 정산의 객체들에 대해서 삭제는 soft delete임을 참고해 주세요! 이는 삭제시 해당 삭제된 객체와 동일한 아이디를 발급할경우 새롭게 생성된 객체가 overwrite 합니다.

---

</div>
<div>
**Response**

```json
{
  "id": "kakao_channel_1",
  "fee": {
    "type": "fixedRate",
    "rate": 50000000 // 5%
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": false,
  "vatPayer": "PARTNER"
}
```

</div>
</div>

---

### 추가 수수료 생성

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

**id** required

추가수수료의 고유 아이디

---

**fee** required

추가 수수료 정보를 보여주는 fee attribute

<table>
  <tr>
    <td>

    additionalFees.**type enum**

    정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’

    </td>

  </tr>
  <tr>
    <td>

    additionalFees.**amount int64**

    정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

    additionalFees.**rate int64**

    정률일경우 백분율로 적용된다. 백분율로써 소수점 첫째자리 까지 가능하다

    </td>

  </tr>
</table>

---

**memo** optional

추가 수수료 내부 구분을 위한 내부 메모

---

**vatPayer** optional 기본값은 PARTNER

부가세 부담여부

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

</div>
<div>
**Request**

```shell
curl -X POST https://api.portone.com/v2/platform/additional-fees/ \
     -u {api_key} \
     -d 'id=kakao_channel_1' \
     -d 'fee[type]=fixedRate' \
     -d 'fee[rate]=50000000' \
     -d 'memo=카카오 마케팅 채널 수수료'

```

**Response**

추가 수수료 객체가 반환됩니다.

```json
{
  "id": "kakao_channel_1",
  "fee": {
    "type": "fixedRate",
    "rate": 50000000 // 5%
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": false,
  "vatPayer": "PARTNER"
}
```

</div>
</div>
---

### 추가 수수료 조회

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

None

</div>
<div>
**Request**

```bash
curl -X GET https://api.portone.com/v2/platform/additional-fees/{id} \
     -u {api_key}
```

**Response**

추가 수수료 객체가 반환됩니다.

```json
{
  "id": "kakao_channel_1",
  "fee": {
    "type": "fixedRate",
    "rate": 50000000 // 5%
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": false,
  "vatPayer": "PARTNER"
}
```

</div>
</div>
---

### 추가 수수료 다건 조회

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameter**

Parameters

**page** optional

페이지 기반의 다건 조회 갯수 조건

page attributes

<table>
  <tr>
    <td>

    page.**number** optional 기본값은 1

    검색 결과에대한 페이징. size에 따라 offset 값이라고 생각하면 됩니다.

    </td>

  </tr>
  <tr>
    <td>

    page.**size** optional 기본값은 10

    각 page당 조회될 할인 유형 객체 갯수.

    </td>

  </tr>
</table>

---

**filter** required

검색 조건

filter attributes

<table>
  <tr>
    <td>

    filter.**includeDeleted** boolean optional 기본값은 false

    </td>

  </tr>
  <tr>
    <td>

    filter.**additionalFeesIds** optional

    추가 수수료 객체 고유 아이디로 구성된 리스트

    </td>

  </tr>
  <tr>
    <td>

    filter.**vatApplied** boolean

    부가세 적용 여부 검색

    </td>

  </tr>
</table>

---

</div>
<div>
**Request**

```bash
curl -X GET https://api.portone.com/v2/platform/additional-fees/numbered-pages \
     -u {api_key} \
     -d 'page[size]=5' \
     -d 'filter[vatApplied]=true'

```

```json
[
  {
    "id": "kakao_channel_1",
    "fee": {
      "type": "fixedRate",
      "rate": 50000000 // 5%
    },
    "memo": "카카오 마케팅 채널 수수료",
    "isDeleted": false,
    "vatPayer": "PARTNER"
  },
  {
    "id": "insta_channel_1",
    "fee": {
      "type": "fixedRate",
      "rate": 70000000 //7%
    },
    "memo": "인스타 마케팅 채널 수수료",
    "isDeleted": false,
    "vatPayer": "PARTNER"
  },
  ...
]
```

</div>
</div>

---

### 추가 수수료 수정

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

**id** required

추가수수료 고유 아이디

---

**fee** required

추가 수수료 정보를 보여주는 fee attribute

<table>
  <tr>
    <td>

    additionalFees.**type enum**

    정률 혹은 정액 구분값. 정률일 경우 ‘fixedRate’, 정액일 경우 ‘fixed_amount’

    </td>

  </tr>
  <tr>
    <td>

    additionalFees.**amount int64**

    정액일 경우 사용하는 parameter. 현재로서 정액 플랫폼 중개 수수료는 원화만 지원한다.

    </td>

  </tr>
  <tr>
    <td>

    additionalFees.**rate int64**

    정률일경우 백분율로 적용된다. 백분율로써 소수점 첫째자리 까지 가능하다

    </td>

  </tr>
</table>

---

**memo** optional

추가 수수료 내부 구분을 위한 내부 메모

---

**vatPayer** optional 기본값은 PARTNER

부가세 부담여부

PARTNER: 부가세 파트너 부담

MERCHANT: 부가세 파트너 미부담

---

**applyAt** Date optional 기본값은 api 호출일

해당 업데이트가 적용되길 원하는 시점. 정산시작일 기준으로 적용날짜를 지정할 수 있다. 즉 **applyAt** 이 2023-03-01이라면 settlementStartDate > 2023-03-01인 transfer_api부터 해당 업데이트된 계약정보가 적용됩니다.

---

</div>
<div>
**Request**

```shell
curl -X PATCH https://api.portone.com/v2/platform/additional-fees/{id} \
     -u {api_key} \
     -d 'fee[rate]=700000000' \
     -d 'applyAt=2023-06-01'
```

**Resposne**

```json
{
  "id": "kakao_channel_1",
  "fee": {
    "type": "fixedRate",
    "rate": 50000000 // 5%
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": false,
  "vatPayer": "PARTNER"
}
```

\- **applyAt** 이 미래시점이라면 해당 업데이트 api의 response 값은 변경되기 전 현재 시점의 정보로 업데이트 됩니다.

</div>
</div>

---

### 추가 수수료 삭제

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameters**

None

</div>
<div>
**Request**

```shell
curl -X DELETE https://api.portone.com/v2/platform/additional-fees/{id} \
     -u {api_key}
```

**Response**

```json
{
  "id": "kakao_channel_1",
  "fee": {
    "type": "fixedRate",
    "rate": 50000000 // 5%
  },
  "memo": "카카오 마케팅 채널 수수료",
  "isDeleted": true,
  "vatPayer": "PARTNER"
}
```

</div>
</div>

---

## 파트너 정산 설정 (In Progress)

<div class="gap-4 md:grid grid-cols-2">
<div>
`파트너 정산 설정` 객체는 가맹점이 파트너에게 정산해줄때 적용될 기본적인 설정을 의미합니다.  정산 계산시 적용될 소수점 처리방식, 각 항목 (중개 수수료, 추가 수수료 ,할인 분담, 결제수수료 (TBA)) 에 대한 구체적 계산 수식을 설정 할 수 있으며 추가로 결제(PG)수수료 파트너 부담여부를 설정 할 수 있습니다.

파트너 정산을 사용하는 가맹점당 단일객체가 발급되며 삭제가 불가능 합니다.

</div>
<div>
**Endpoints**

```text
POST platform/platform-merchant
GET platform/platform-merchant
POST platform/additional-fees/platform-merchant
```

</div>
</div>

---

### 파트너 정산 설정 객체

<div class="gap-4 md:grid grid-cols-2">
<div>
**Parameter**

**merchant_id** string

포트원이 부여한 가맹점 고유 아이디

---

**roundType** enum

정산식 계산시 적용될 소수점 처리 방식. 내림, 올림, 반올림이 있다. 각각의 수수료와 부가세 및 할인 분담금액을 계산할때 적용된다.

- OFF: 반올림
- DOWN: 내림
- UP: 올림

---

**channelFeePayer** enum

현재는 지원하지 않는 기능이나, PG사가 가맹점에게 부여하는 결제 수수료를 파트너에게 부담할 경우 해당 값을 파트너 (PARTNER)로 지정 하면 됩니다. 그럴경우 정산계산을 위해 사용하시는 pg사의 수수료를 계산하여 차감합니다.

- PARTNER: 결제수수료 파트너 부담일경우
- MERCHANT: 결제수수료를 가맹점이 부담할 경우

---

**settlementFormula** dicitionary

전체 정산과 각 수수료 및 할인분담금을 계산하는데 적용되는 수식에 대한 값입니다. 다만 현재는 해당 값은 `관리자콘솔 > 파트너 정산 > 계약관리 > 수식` 에서 확인 및 수정하실 수 있으십니다.

<table>
  <tr>
    <td>
      <div class="text-sm text-gray-500">
        <div class="font-bold">settlementFormula.platformFee</div>
        <div>중개수수료 수식</div>
      </div>
    </td>
  </tr>
  <tr>
    <td>
      <div class="text-sm text-gray-500">
        <div class="font-bold">settlementFormula.channelFee (TBA)</div>
        <div>결제수수료 수식</div>
      </div>
    </td>
  </tr>
  <tr>
    <td>
      <div class="text-sm text-gray-500">
        <div class="font-bold">settlementFormula.discountShare</div>
        <div>할인분담금 수식</div>
      </div>
    </td>
  </tr>
  <tr>
    <td>
      <div class="text-sm text-gray-500">
        <div class="font-bold">settlementFormula.additionalFee</div>
        <div>추가 수수료 수식</div>
      </div>
    </td>
  </tr>
</table>

---

</div>
</div>
---

## 정산

<div class="gap-4 md:grid grid-cols-2">
<div>
`정산` 객체는 특정 파트너에게 정산금액을 등록할때 생성 됩니다.

고객의 결제(order)로 부터 계약 규칙에 맞게 파생되는 정산금과 수동으로(manual) 임의의 정산금액을 등록할 수 있습니다. 고객의 결제건에 대해서는 결제/환불 모두 적용할 수 있습니다.

</div>
<div>
**Endpoints**

```text
POST platform/transfer/order
POST platform/transfer/manual
GET platform/transfer/{id}
GET platform/transfers
POST platform/transfer/{id}/status

```

</div>
</div>

### 정산 객체

<div class="gap-4 md:grid grid-cols-2">
<div>
Attributes

**id** string

Unique identifier for the object

---

**type** enum

| Enum Values | Description                       |
| ----------- | --------------------------------- |
| PAYMENT     | 주문 결제건(order)에 대한 정산    |
| CANCEL      | 주문 결제 (order) 취소에대한 정산 |

---

**isExternal** bool

주문 결제건에 대한 정산일시 포트원 결제연동 서비스를 통한 결제인지 아닌지 구분.

---

**amount** int64 if manual, else dictionary

- (manual) 수동 정산 건일 경우 정산금. 음수 및 양수 둘다 가능하다.
- (order) 주문 결제건 정산일 경우 order attributes

<table>
  <tr>
    <td>
    
    order.**settlement** int64 
    
    주문 금액으로 부터 도출된 최종 정산금액
    
    </td>
  </tr>
  <tr>
    <td>
      
      order.**orderAmount** int64 
      
      주문 금액. 기본값은 결제금액(transaction) +할인금액(discount_amount)

    </td>

  </tr>
  <tr>
    <td>
      
      order.**platformFee** int64 
      
      주문 금액에서 차감될 플랫폼 중개 수수료 금액
      
    </td>
  </tr>
  <tr>
    <td>
    
    order.**platoformFeeVst** int64 
    
    중개 수수료 금액 부가세
    
    </td>
  </tr>
  <tr>
    <td>
      order.**additionalFee** int64 
      
      주문 금액에서 차감될 추가 수수료 금액
      
    </td>
  </tr>
  <tr>
    <td>
    
    order.**additionalFeeVst** int64 
    
    추가 수수료 부가세 금액
    
    </td>
  </tr>
  <tr>
    <td>
    
    order.**discount** int64 
    
    주문에 적용돈 할인 금액
    
    </td>
  </tr>
  <tr>
    <td>
    
    order.**discountShare** int64 
    
    할인 금액 중 파트너가 부담할 금액
    
    </td>
  </tr>
  <tr>
    <td>
    
    order.**channelFee** int64 (TBA)
    
    주문에 적용된 결제 수수료 금액
    
    </td>
  </tr>
  <tr>
    <td>
    
    order.**channelFeeVst** int64 (TBA)
    
    결제 수수료 부가세 금액
    
    </td>
  </tr>
</table>

---

**partnerId** string

파트너에게 부여한 고유 아이디 입니다. 정산객체 정보가 등록될 파트너의 정보입니다.

---

**contractId** string

정산객체의 각 수수료 및 정산금 (amount.order) 와 정산일 (settlementDate) 를 계산하는데 적용될 계약객체의 아이디 입니다. 수동정산(manual) 일경우 적용되지 않습니다.

---

**paymentInfo** dictionary

주문 정산건(order)일 경우 해당 주문아이디와 상점 정보

<table>
  <tr>
    <td>

    paymentInfo.**paymentId** string

    포트원 결제호출시 전달하는 가맹점 주문번호

    </td>

  </tr>
  <tr>
    <td>
    
    paymentInfo.**storeId** string 
    
    포트원이 부여한 가맹점 상점 아이디
    
    </td>
  </tr>
</table>

---

**settlementStartDate** Date

정산 시작일. 주문 완료와 같이 정산에 고려되기 시작하는 시점이다. 기본값은 포트원 결제완료 시점으로 적용된다. 수동정산(manual)일 경우 적용되지 않습니다.

---

**settlementDate** Date

정산일. 정산주기에 맞게 파트너에게 이체되어야 하는 시점이다.

---

**additionalFees** list of dictionary

추가수수료 (additionalFee) 객체의 리스트

- additionalFee attributes

<table>
  <tr>
    <td>

    additionalFee.**id** string

    추가수수료 객체 고유 아이디
    </td>

  </tr>
  <tr>
    <td>
    
    additionalFee.**memo** string
    
    추가수수료 객체 가맹점 지정 내부 메모
    
    </td>
  </tr>
  <tr>
    <td>
    
    additionalFee.**fee** dictionary
    
    추가수수료 객체의 수수료 정보 로써 Fee attributes 이다. Fee attributes 은 정률,정액으로 나뉜다.

    \- fee.type enum: “fixed_amount” , “fixedRate”\
    \- fee.amount int64: 정액(fixed_amount) 일경우\
    \- fee.rate int64: 정률(fixedRate)일 경우

    </td>

  </tr>
</table>

---

**discounts** list of dictionary

할인 유형 (discount-shares) 객체의 리스트

리스트의 각 객체별 단일 할인에 해당된다.

- discount-shares

<table>
  <tr>
    <td>

    discount-shares.**id** string

    할인 유형 객체 고유아이디
    </td>

  </tr>
  <tr>
    <td>
    
    discount-shares.**partnerShareRate** int64
    
    할인 유형 할인 분담율
    
    </td>
  </tr>
  <tr>
    <td>
    
    discount-shares.**memo** string
    
    할인 유형 내부 메모
    
    </td>
  </tr>
  <tr>
    <td>
    
    discount-shares.**discount-share** int64
    
    할인 적용 금액
    
    </td>
  </tr>
</table>

---

**status** enum

정산의 상태값
|Enum Value|Description|
| --- | --- |
| SCHEDULED |정산 시작일(settlementStartDate)이 현시점 이후일때 예약 상태 |
| IN_PROCESS |현시점이 정산 시작일 이후 정산일(settlementDate) 이전일때 진행중 상태 |
| SETTLED |현시점이 정산일 이후일때 완료 상태 |
| PAID_OUT |이체 완료 상태 |
| REJECTED |이체 취소 상태. SETTLED이고 이체파일 생성하였으나 실제 이체를 진행하지 않은 경우. |
| PENDING |이체 보류 상태. 특정 정산건에 대해서 정산일과 무관하게 보류로 지정할시 이체(payout) batch에 포함되지 않습니다. |

---

**paymentCancellationId** string

결제 취소 아이디. 주문건에 대해서 전체 및 부분취소진행시 연관된 정산 객체의 조정을 위해 필요한 포트원 결제취소 아이디 입니다. \*결제취소 아이디는 포트원의 v2/api로 발급되는점 유의하시기 바랍니다. [링크](https://app.gitbook.com/o/nad6nqI7LNE1TGdY19Od/s/wWX2hlvRZLZrXeH1aacF/api-v2/payment)

---

**payoutId** string

정산 객체가 정산주기에 맞춰서 포함될 이체 객체의 고유 아이디

---

**memo** string

수동 정산(manual)에 한해서 정산객체에 고객이 부여하는 내부 메모

---

</div>
<div>
**Response (order)**

```json
{
  "id": "transfer_1",
  "type": "PAYMENT",
  "isExternal": false,
  "amount": {
    "settlement": 300,
    "orderAmount": 1000,
    "platformFee": 100,
    "platformFee_vst": 10,
    "additionalFee": 100,
    "additionalFeeVst": 10,
    "discount": 100,
    "discountShare": 50,
    "channelFee": 30,
    "channelFeeVst": 3,
  },
  "partnerId": "lecturer_1",
  "contractId": "contract_1",
  "paymentInfo": {
    "paymentId": "merchant_uid1",
    "storeId": "storeId_1"
  },
  "settlementStartDate": "2023-01-01",
  "settlementDate": "2023-01-31",
  "additionalFees": [{
    "id": "af_1",
    "memo": "로켓배송 수수료",
    "fee": {
      "type": "fixedRate",
      "rate": 10,
    }
  }],
  "discounts": [{
    "id": "coupon_1",
    "partnerShareRate": 50,
    "memo": "하계 브랜드 쿠폰",
    "amount": 1000
  }],
  "status": "IN_PROCESS",
  "paymentCancellationId": "cancel_123",
  "payoutId": "payout_1",
  "memo": null
}
```

**Response (manual)**

```json
{
  "id": "transfer_1",
  "type": "MANUAL",
  "amount": 300,
  "partnerId": "lecturer_1",
  "settlementDate": "2023-01-31",
  "status": "IN_PROCESS",
  "payoutId": "payout_1",
  "memo": "이체건 차감"
}
```

</div>
</div>
---

### 주문 정산건 생성

<div class="gap-4 md:grid grid-cols-2">
<div>
주문 정산건이란 결제를 기반으로 한 주문건에 대해서 각 파트너에게 정산해주기 위한 정산객체를 api로 등록하는 겁니다.

**Parameters**

**type** required

결제용(PAYMENT) 인지 결제 취소 용 (CANCELLATION)인지 설정

결제 취소용 일 경우 **amount**가 음수 처리

---

**partnerId** required

주문 정산건에 해당되는 파트너 지정

---

**paymentInfo[paymentId]** required

주문 정산건에 해당되는 주문번호. 포트원 결제 연동 서비스 (sdk, api)에 등록되는 가맹점의 merchant_uid 값을 건내주셔야 합니다.

---

**isExternal** optional 기본값은 false

주문 정산건에 해당되는 결제가 포트원 서비스를 통한 결제가 아닐경우 true. 이를 외부결제건이라 칭합니다.

외부 결제건일 경우 **orderAmount** 혹은 **transaction** 둘중 하나를 필수로 전달해야 합니다.

---

**amount** optional

order 의 일부 attributes

<table>
  <tr>
    <td>

    order.**orderAmount** optional

    주문금액. 결제금액 + 할인금액 입니다.

    기본값은 결제금액 과 할인금액의 합이며 이와 상이한 값을 전달할 경우 에러를 반환합니다.

    </td>

  </tr>
  <tr>
    <td>

    order.**discount**

    할인금액

    주문에 적용된 쿠폰 및 포인트의 총 합 금액입니다. discounts 에서 적용된 모든 할인금액의 총 합입니다.

    </td>

  </tr>
  <tr>
    <td>

    order.**transaction**

    결제금액. 주문금액 - 할인금액 입니다.

    </td>

  </tr>
</table>

---

**contractId** optional

주문 정산건에 적용될 계약의 아이디. 기본으로 정산될 파트너의 기본 계약이 적용되지만 **contractId** 를 통해 다른 계약을 지정할 경우 지정된 계약의 정보가 적용된다.

---

**settlementStartDate** optional 기본값은 결제완료 시점

정산 시작일로써 정산 주기가 적용될 날짜이다. 주문완료, 배송완료 등 정산이 고려되기 시작해야하는 시간을 뜻한다. 기본값은 주문정산건과 연결된 결제의 완료 시점으로 업데이트 된다.

배송완료 예정일, 수강 오픈일, 등 미래시점으로 지정해 놓으면 해당 시점부터 정산주기가 적용되며 그동안 정산객체의 상태값은 준비 (PREPARE)로 적용된다.

---

**additionalFees** optional

주문 정산건에 적용될 추가 수수료들의 리스트. 추가 수수료 객체들로 이루어져있다.

추가수수료란 특정 주문정산건에 가맹점이 파트너에게 추가 서비스를 제공함으로써 과금되는 수수료 이다. 정산수식에대한 수정이 있지 않는한 기본으로 추가수수료는 주문금액에 부과된다.

<table>
  <tr>
    <td>

    additionalFee.**id** string

    추가수수료 객체 고유 아이디
    </td>

  </tr>
</table>

---

**discounts** optional

주문 정산건에 적용된 할인 유형들의 리스트. 할인 유형 객체들로 이루어져있다.

할인 유형이란 특정 주문에 적용된 할인에 대해서 유형별 파트너 분담율을 정산에 계산하기 위한 객체이다.

<table>
  <tr>
    <td>

    discount.**id** string

    할인 유형 객체 고유 아이디
    </td>

  </tr>
  <tr>
    <td>

    discount.**amount** int64

    할인 적용 금액
    </td>
    </tr>

</table>

---

**paymentCancellationId** optional

**TYPE** 이 CANCEL 이고 전체 취소일 경우 주문 정산건에 연결될 결제취소 아이디를 전달하여 **orderAmount** 및 **transaction** 정보 없이 정산 할 수 있다.

허나 부분취소일 경우에는 부분취소로인해 영향받을 파트너와 취소될 금액을 **partnerId**, **orderAmount** 및 **transaction** 으로 지정해서 등록해야한다.

</div>
<div>
**Request**

```text
curl -X POST https://api.portone.com/v2/platform/transfer/order \
     -u {api_key} \
     -d 'type=PAYMENT' \
     -d 'partnerId=lecturer_1' \
     -d 'paymentInfo[paymentId]=merchant_uid1' \
     -d 'discounts=[{"id":"coupon_1","amount":1000}]'

```

**Response**
주문 정산객체가 반환됩니다.

- 정산시작일(settlementStartDate)을 전달하지 않을경우 결제완료 시점으로 기본으로 지정됩니다. 이 경우 정산 api호출시점에 결제완료가 아직 되지 않았다면 에러를 반환합니다.
- 정산시작일(settlementStartDate)을 미래의 시점으로 전달할 경우 status 는 SCHEDULED이고 이에 적용될 계약정보는 정산api를 호출한 시점에 등록된 계약으로 적용되나 계약정보가 바뀌어 업데이트 될 여지가 있습니다.

```json
{
  "id": "transfer_1",
  "type": "PAYMENT",
  "isExternal": false,
  "amount": {
    "settlement": 300,
    "orderAmount": 1000,
    "platformFee": 100,
    "platformFeeVst": 10,
    "additionalFee": 100,
    "additionalFeeVst": 10,
    "discount": 100,
    "discountShare": 50,
    "channelFee": 30,
    "channelFeeVst": 3,
  },
  "partnerId": "lecturer_1",
  "contractId": "contract_1",
  "paymentInfo": {
    "paymentId": "merchant_uid1",
    "storeId": "storeId_1"
  },
  "settlementStartDate": "2023-01-01",
  "settlementDate": "2023-01-31",
  "additionalFees": [],
  "discounts": [{
    "id": "coupon_1",
    "partnerShareRate": 50,
    "memo": "하계 브랜드 쿠폰",
  }],
  "status": "IN_PROCESS",
  "paymentCancellationId": "cancel_123",
  "payoutId": "payout_1",
  "memo": null
}
```

</div>
</div>
---

### 수동 정산건 생성

<div class="grid-cols-2 gap-4 md:grid">
  <div>
  수동 정산건이란 결제를 기반으로 하지않고 고객이 원하는 만큼 파트너에게 정산금을 추가 및 차감할 수 있는 api입니다.

**Parameters**

**partnerId** required

해당 수동 정산건이 적용될 파트너의 고유 아이디

---

**amount** required

해당 수동 정산건으로 적용하길 원하는 금액. 음수 및 양수 둘다 가능하다.

---

**settlementDate** optional 기본값은 파트너의 다가올 정산일

해당 수동 정산건이 적용되길 원하는 정산일. 전달하지 않을경우 해당 파트너의 가장 가까운 미래 정산일이 적용된다.

---

**memo** optional

해당 수동 정산건 등록시 내부 관리를 위해 전달하는 메모.

  </div>
  <div>
  **Request**

```text
curl -X POST https://api.portone.com/v2/platform/transfer/manual \
     -u {api_key} \
     -d 'partnerId=lecturer_1' \
     -d 'amount=300000' \
     -d 'settlementDate=2023-01-31' \
     -d 'memo=이체건 차감'

```

**Response**

수동 정산객체가 반환된다.

```json
{
  "id": "transfer_1",
  "type": "PAYMENT",
  "amount": 300000,
  "partnerId": "lecturer_1",
  "settlementDate": "2023-01-31",
  "status": "IN_PROCESS",
  "payoutId": "payout_1",
  "memo": "이체건 차감"
}
```

  </div>
</div>

---

### 정산 조회

<div class="grid-cols-2 gap-4 md:grid">
  <div>
  등록된 정산객체를 조회합니다.

**Parameters**

없습니다.

  </div>
  <div>
  ****Request****

```text
curl -X GET https://api.portone.com/v2/platform/transfer/{id} \
     -u {api_key}
```

**Response**

정산객체가 반환됩니다.

  </div>
  </div>
