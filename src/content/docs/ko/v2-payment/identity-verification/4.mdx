---
emoji: ğŸ¤¹
title: 4. ì¸ì¦ì •ë³´ ì¡°íšŒ ë° í™œìš©í•˜ê¸°
description: ì¸ì¦ì •ë³´ë¥¼ íšë“í•˜ê³  í™œìš©í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.
---

import * as prose from "~/components/prose";
export const components = prose;

import Hint from "~/components/gitbook/Hint.astro";
import Tabs from "~/components/gitbook/tabs/Tabs.astro";
import Tab from "~/components/gitbook/tabs/Tab.astro";

íœ´ëŒ€í° ë³¸ì¸ì¸ì¦ ì™„ë£Œì´í›„ íšë“í•œ `identity_verification_id`ë¥¼ ì´ìš©í•˜ì—¬ ê³ ê° ì¸ì¦ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì¸ì¦ ê²°ê³¼ ì¡°íšŒ API êµ¬í˜„í•˜ê¸°

ì•„ë˜ ì½”ë“œëŠ” API KEYë¥¼ ì´ìš©í•´ access_tokenì„ ë¨¼ì € ë°œê¸‰í•˜ê³ , ì´ë¥¼ ì´ìš©í•´ í¬íŠ¸ì›ì˜ <mark style="color:blue;">**ë³¸ì¸ì¸ì¦ ê²°ê³¼ì¡°íšŒ API**</mark>ë¥¼ í˜¸ì¶œí•˜ì—¬ ì¸ì¦ ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.

```javascript title="server-side"
app.use(bodyParser.json());
  ...
  // "/identity-verifications"ì— ëŒ€í•œ POST ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” controller
  app.post("/identity-verifications", async (request, response) => {
    // requestì˜ bodyì—ì„œ identityVerificationIdì™€ identityVerificationTxId ì¶”ì¶œ
    const { identityVerificationId } = request.body;
    try {
      // 1. í¬íŠ¸ì› APIë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì•¡ì„¸ìŠ¤ í† í° ë°œê¸‰ ë°›ê¸°
      const signinResponse = await axios({
        url: "https://api.portone.io/v2/signin/api-key",
        method: "post",
        headers: { "Content-Type": "application/json" },
        data: {
          api_key: PORTONE_API_KEY, // í¬íŠ¸ì› API Key
        },
      });
      const { access_token } = signinResponse.data;

      // 2. í¬íŠ¸ì› ê²°ì œë‚´ì—­ ë‹¨ê±´ì¡°íšŒ API í˜¸ì¶œ
      const verificationResponse = await axios({
        url: `https://api.portone.io/v2/identity-verifications/${identityVerificationId}`,
        method: "get",
        // 1ë²ˆì—ì„œ ë°œê¸‰ë°›ì€ ì•¡ì„¸ìŠ¤ í† í°ì„ Bearer í˜•ì‹ì— ë§ê²Œ ë„£ì–´ì£¼ì„¸ìš”.
        headers: { "Authorization": "Bearer " + access_token },
      });
      const identityVerification = verificationResponse.data;
      if (identityVerification.status !== "VERIFIED") {
        // ì¸ì¦ ì‹¤íŒ¨
        ...
      }
      ...
    } catch(e) {
      console.error(e);
    }
  });
```

### ì¸ì¦ ì •ë³´ í™œìš©í•˜ê¸°

ì¡°íšŒí•œ ì¸ì¦ ì •ë³´ì—ì„œ ë‹¤ìŒì˜ ê³ ê° ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ì„œë¹„ìŠ¤ ì½”ë“œ ì˜ˆì œì…ë‹ˆë‹¤.

- `ci`: ì—°ê³„ ì •ë³´(Connecting Information). ì‚¬ëŒë§ˆë‹¤ ê³ ìœ í•˜ê³  ì„œë¹„ìŠ¤ë³„ë¡œ ë‹¬ë¼ì§€ì§€ ì•Šê¸° ë•Œë¬¸ì—, ì„œë¹„ìŠ¤ ê°„ ì—°ê³„ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.
- `di`: ì¤‘ë³µ ê°€ì… í™•ì¸ ì •ë³´(Duplication Information). í•´ë‹¹ ì„œë¹„ìŠ¤ ì•ˆì—ì„œë§Œ ì‚¬ëŒë§ˆë‹¤ ê³ ìœ í•¨. ì´ìš©ìì˜ ì¤‘ë³µ ê°€ì…ì„ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.
- `name`: ì´ë¦„
- `gender`: ì„±ë³„
- `birthDate`: ìƒë…„ì›”ì¼ (YYYY-MM-DD)

<Hint style="info">
  ìœ„ì˜ ì •ë³´ ì™¸ì— ì™¸êµ­ì¸(**`isForeigner`**) ì—¬ë¶€ëŠ” **API ë°©ì‹** ë³¸ì¸ì¸ì¦ì— í•œí•˜ì—¬ **ê°œì¸ì •ë³´ ì œê³µë™ì˜ ì•½ê´€ì„ ì‚¬ì´íŠ¸ì— ê²Œì¬**í•œ í›„ <mark style="color:red;">**cs@portone.io**</mark>**ë¡œ ì‹ ì²­**í•˜ì—¬ ì·¨ë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë¶€ë¶„ì€ ë‹¹ì‚¬ ê³„ì•½ ì´í›„ ë‹¤ë‚ PGì‚¬ë¡œ ìš”ì²­ í›„ ìŠ¹ì¸ì´ ì™„ë£Œë˜ë©´ ì´ìš© ê°€ëŠ¥í•œ ì  ì°¸ê³ í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.

**ë©”ì¼ ìš”ì²­ ì‹ ì²­ ì–‘ì‹**

- ìƒí˜¸ëª… :
- ì‚¬ì—…ìë²ˆí˜¸ :
- ë³¸ì¸ì¸ì¦ìš© ë‹¤ë‚  ìƒì ID(CPID) :
- ì—…ì¢… :
- í•„ìš”ì‚¬ìœ  :
- ê°œì¸ì •ë³´ì·¨ê¸‰ë°©ì¹¨ url : ì•±ì„œë¹„ìŠ¤ë¡œ URLí˜•íƒœë¡œ ì „ë‹¬ì´ ì–´ë ¤ìš°ì‹  ê²½ìš° 'ê°œì¸ì •ë³´ì·¨ê¸‰ë°©ì¹¨' ê²½ë¡œë¥¼ ìº¡ì³í•˜ì—¬ ì „ë‹¬ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.

**ì°¸ê³  - í¬íŠ¸ì› ì´ìš© ê°€ë§¹ì ì˜ ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ ì ìš© ì˜ˆì‹œ**

- `(ì£¼)ë§ˆí”Œ : https://marpple.shop/kr/@/privacy`
- `(ì£¼)ë¸Œë ˆì´ë¸Œëª¨ë°”ì¼ / ìˆ¨ê³  : https://soomgo.com/terms/privacy`
- `(ì£¼)ë§ˆì¼“ì‡ : https://static.marketit.asia/static/privacy-terms.pdf`

</Hint>

<font size="2">
```javascript title="Node.js"
  // "/identity-verifications"ì— ëŒ€í•œ POST ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” controller
  app.post("/identity-verifications", async (request, response) => {
    // requestì˜ bodyì—ì„œ identity_verification_id ì¶”ì¶œ
    const { identity_verification_id } = request.body;
    try {
      // ì¸ì¦ í† í° ë°œê¸‰ ë°›ê¸°
      /* ...ì¤‘ëµ... */
      // identity_verification_idë¡œ ì¸ì¦ ì •ë³´ ì¡°íšŒ
      /* ...ì¤‘ëµ... */
      const { ci, di, name, gender, birthDate } = identityVerification.customer;
      ...
      // ì—°ë ¹ ì œí•œ ë¡œì§ ì˜ˆì‹œ
      if (new Date(birthDate).getFullYear() <= 1999) {
        // ì—°ë ¹ ë§Œì¡±
      } else {
        // ì—°ë ¹ ë¯¸ë‹¬
      }
      ...
      // 1ì¸ 1ê³„ì • í—ˆìš© ë¡œì§ ì˜ˆì‹œ
      // DBì—ì„œ di ì¡°íšŒ í›„ ê°€ì…ì—¬ë¶€ ê²€ì‚¬
      const user = await Users.find({ di: di });
      if (!user) {
        // ì‹ ê·œ ê³ ê°
      } else {
        // ì´ë¯¸ ê°€ì…ëœ ê³ ê°
      }
    } catch(e) {
      console.error(e);
    }
  });
```
</font>

