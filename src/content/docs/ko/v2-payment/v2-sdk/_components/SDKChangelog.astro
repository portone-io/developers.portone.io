---
import rehypeStringify from "rehype-stringify";
import remarkGfm from "remark-gfm";
import remarkParse from "remark-parse";
import remarkRehype from "remark-rehype";
import { unified } from "unified";

import Prose from "~/components/Prose.astro";

const response = await fetch(
  "https://api.github.com/repos/portone-io/browser-sdk/contents/packages/browser-sdk/CHANGELOG.md",
  {
    headers: {
      Accept: "application/vnd.github+json",
      Authorization: `Bearer ${import.meta.env.GITHUB_JS_SDK_CHANGELOG_TOKEN}`,
      "X-GitHub-Api-Version": "2022-11-28",
    },
  },
);
const json = await response.json();
const content = Buffer.from(json.content, "base64").toString("utf-8");
const html = await unified()
  .use(remarkGfm)
  .use(remarkParse)
  .use(remarkRehype)
  .use(rehypeStringify)
  .process(content);
---

<Fragment set:html={html} />
<Prose />
