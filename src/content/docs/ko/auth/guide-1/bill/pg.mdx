---
emoji: ğŸ›¡
title: PGê²°ì œì°½ ì´ìš©í•˜ê¸°
description: PGì‚¬ì—ì„œ ì œê³µí•˜ëŠ” ê²°ì œì°½ì„ ì´ìš©í•˜ì—¬ ë¹Œë§í‚¤ë¥¼ íšë“í•©ë‹ˆë‹¤
---

import * as prose from "~/components/prose";
export const components = prose;

import Figure from "~/components/gitbook/Figure.astro";
import Hint from "~/components/gitbook/Hint.astro";
import Tabs from "~/components/gitbook/tabs/Tabs.astro";
import Tab from "~/components/gitbook/tabs/Tab.astro";

#### PGì‚¬ê°€ ì œê³µí•˜ëŠ” ì¼ë°˜ ê²°ì œì°½ì— ê³ ê°ì´ ì¹´ë“œì •ë³´ë¥¼ ì…ë ¥í•˜ì—¬ ë¹Œë§í‚¤ë¥¼ ë°œê¸‰ ë°›ì„ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **ì¥ì **: ì¹´ë“œì •ë³´ê°€ ì„œë²„ ë˜ëŠ” í¬íŠ¸ì›ì˜ ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  ì§ì ‘ PGì‚¬ë¡œ ì „ë‹¬ë˜ê¸° ë•Œë¬¸ì— ë°ì´í„° ë° í†µì‹ êµ¬ê°„ ì•”í˜¸í™” ë“±ì˜ **ì¶”ê°€ ë³´ì•ˆ í”„ë¡œì„¸ìŠ¤ê°€ ì—†ë‹¤**.
- **ë‹¨ì **: PGì‚¬ì˜ ì¼ë°˜ê²°ì œì°½ì„ í†µí•´ ì¹´ë“œì •ë³´ë¥¼ ì…ë ¥ë°›ê¸° ë•Œë¬¸ì— ì›¹ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ì„œë§Œ ë¹Œë§í‚¤ ë°œê¸‰ì´ ì´ë£¨ì–´ì§€ë©°, **ì¹´ë“œì •ë³´ ì…ë ¥ë€ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•  ìˆ˜ ì—†ë‹¤.**(ê°€ë§¹ì  ì‚¬ì´íŠ¸ ì¹œí™”ì ì¸ UI/UX êµ¬ì„±ë¶ˆê°€)

<Figure
  src="/gitbook-assets/ko/image (269).png"
  caption="PGì‚¬ ì¹´ë“œì •ë³´ íšë“ ê²°ì œì°½ ì˜ˆì œ"
/>

### <mark style="color:blue;">**STEP 01.**</mark> ë°œê¸‰ ìš”ì²­í•˜ê¸°

ì¸ì¦ê²°ì œì™€ ë™ì¼í•˜ê²Œ **JavaScript SDK** ë¥¼ ì´ìš©í•˜ì—¬ PGì‚¬ ê²°ì œì°½ì„ í˜¸ì¶œí•©ë‹ˆë‹¤. ë¹Œë§í‚¤ë¥¼ íšë“í•˜ê¸° ìœ„í•´ ì•„ë˜ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€ì ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë©ë‹ˆë‹¤.

> #### customer_uid : ë¹Œë§í‚¤ì™€ 1:1ë¡œ ë§¤ì¹­ë  ê³ ìœ í‚¤

<Tabs>
<Tab title="JavaScript">
```javascript title="client-side"
  IMP.request_pay({ 
    customer_uid: "gildong_0001_1234", // ì¹´ë“œ(ë¹Œë§í‚¤)ì™€ 1:1ë¡œ ëŒ€ì‘í•˜ëŠ” ê°’
    /* ...ìƒëµ... */
  }, function (rsp) { // callback
    if (rsp.success) {
      // ë¹Œë§í‚¤ ë°œê¸‰ ì„±ê³µ
    } else {
      // ë¹Œë§í‚¤ ë°œê¸‰ ì‹¤íŒ¨
    }
  });
```

<Hint style="info">
**customer\_uid ë€?**

PGì‚¬ê°€ ë°œê¸‰í•œ ë¹Œë§í‚¤ì™€ 1:1ë¡œ ë§µí•‘ë˜ëŠ” ê°€ë§¹ì ì´ ì§€ì •í•œ ê³ ìœ ê°’ì…ë‹ˆë‹¤. customer_uid ëŠ” ì¹´ë“œë²ˆí˜¸ ë‹¨ìœ„ë¡œ êµ¬ë¶„ë˜ì„œ ì €ì¥ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

ì˜ˆ) **í™ê¸¸ë™** ê³ ê°ì´ **Aì¹´ë“œ** ë¹Œë§í‚¤ë¥¼ ìš”ì²­í•˜ëŠ” ê²½ìš° customer_uidëŠ” **íšŒì› ë³„ ì¹´ë“œë²ˆí˜¸ ë‹¨ìœ„**ë¡œ ê³ ìœ í•˜ê²Œ ë°œê¸‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

</Hint>

</Tab>
</Tabs>

### <mark style="color:blue;">**STEP 02.**</mark> ë°œê¸‰ ì‘ë‹µ ì²˜ë¦¬í•˜ê¸°

<Tabs>
<Tab title="JavaScript">
```javascript title="client-side"
  IMP.request_pay({ 
    /* ...ì¤‘ëµ... */
  }, function (rsp) { // callback
    if (rsp.success) {
      // ë¹Œë§í‚¤ ë°œê¸‰ ì„±ê³µ
      // jQueryë¡œ HTTP ìš”ì²­
      jQuery.ajax({
        url: "{customer_uidë¥¼ ë°›ì„ ì„œë¹„ìŠ¤ URL}", 
        method: "POST",
        headers: { "Content-Type": "application/json" },
        data: {
          customer_uid: "gildong_0001_1234", // ì¹´ë“œ(ë¹Œë§í‚¤)ì™€ 1:1ë¡œ ëŒ€ì‘í•˜ëŠ” ê°’
        }
      });
    } else {
      // ë¹Œë§í‚¤ ë°œê¸‰ ì‹¤íŒ¨
    }
  });
```

ë¹Œë§í‚¤ê°€ ì„±ê³µì ìœ¼ë¡œ ë°œê¸‰ë˜ë©´ ê°€ë§¹ì  ì„œë²„ë¡œ **customer_uid** ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. ì„œë²„ì—ì„œëŠ” í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° **customer_uid**ë¥¼ ì „ë‹¬ë°›ëŠ” API endpointë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì„œë²„ì—ì„œ í•´ë‹¹ **customer_uid** ë¥¼ ì‚¬ìš©í•˜ì—¬ ì°¨í›„ì— ê²°ì œë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript title="server-side"
  app.post("/billings", async (req, res) => {
    try {
      const { customer_uid } = req.body; // req bodyì—ì„œ customer_uid ì¶”ì¶œ
        ...
    } catch (e) {
      res.status(400).send(e);
    }
  });
```

ì „ë‹¬ë°›ì€ customer_uid ë¥¼ ê°€ë§¹ì  ë‚´ë¶€ì„œë²„ DBì— ì €ì¥ í›„ ì¶”í›„ í•´ë‹¹ ì •ë³´ë¥¼ ì´ìš©í•˜ì—¬ ê²°ì œë¥¼ ìš”ì²­ í•©ë‹ˆë‹¤.

</Tab>
</Tabs>

### <mark style="color:blue;">**STEP 03.**</mark> ê²°ì œ ìš”ì²­í•˜ê¸°

ìœ„ì—ì„œ ì €ì¥ëœ **customer_uid** ë¥¼ ì´ìš©í•˜ì—¬ [**ë¹„ ì¸ì¦ ê²°ì œ(ë¹Œë§í‚¤)API**](../../../api/api-4/api)ë¥¼ í˜¸ì¶œí•˜ì—¬ ê²°ì œë¥¼ ìš”ì²­í•©ë‹ˆë‹¤.

<Hint style="success">
**REST API ë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ì„œëŠ”** [**Access Token**](../../../api/rest-api-access-token) **íšë“ì´ ì„ í–‰ë˜ì–´ì•¼ í•˜ëŠ”ì  ìŠì§€ ë§ˆì„¸ìš”**

</Hint>

<Tabs>
<Tab title="Node.js">
```javascript title="server-side"
app.post("/billings", async (req, res) => {
    try {
      const { customer_uid } = req.body; // reqì˜ bodyì—ì„œ customer_uid ì¶”ì¶œ
      // ì¸ì¦ í† í° ë°œê¸‰ ë°›ê¸°
      const getToken = await axios({
        url: "https://api.iamport.kr/users/getToken",
        method: "post", // POST method
        headers: { "Content-Type": "application/json" }, 
        data: {
          imp_key: "imp_apikey", // REST API í‚¤
          imp_secret: "ekKoeW8RyKuT0zgaZsUtXXTLQ4AhPFW3ZGseDA6bkA5lamv9OqDMnxyeB9wqOsuO9W3Mx9YSJ4dTqJ3f" // REST API Secret
        }
      });
      const { access_token } = getToken.data; // ì¸ì¦ í† í°
      ...
      // ê²°ì œ(ì¬ê²°ì œ) ìš”ì²­
      const paymentResult = await axios({
        url: \`https://api.iamport.kr/subscribe/payments/again\`,
        method: "post",
        // ì¸ì¦ í† í°ì„ Authorization headerì— ì¶”ê°€
        headers: { "Authorization": access_token }, 
        data: {
          customer_uid,
          merchant_uid: "order_monthly_0001", // ìƒˆë¡œ ìƒì„±í•œ ê²°ì œ(ì¬ê²°ì œ)ìš© ì£¼ë¬¸ ë²ˆí˜¸
          amount: 8900,
          name: "ì›”ê°„ ì´ìš©ê¶Œ ì •ê¸°ê²°ì œ"
        }
      });
      ...
      const { code, message } = paymentResult;
      if (code === 0) { // ì¹´ë“œì‚¬ í†µì‹ ì— ì„±ê³µ(ì‹¤ì œ ìŠ¹ì¸ ì„±ê³µ ì—¬ë¶€ëŠ” ì¶”ê°€ íŒë‹¨ì´ í•„ìš”í•¨)
        if ( paymentResult.status === "paid" ) { //ì¹´ë“œ ì •ìƒ ìŠ¹ì¸
          res.send({ ... });
        } else { //ì¹´ë“œ ìŠ¹ì¸ ì‹¤íŒ¨ (ì˜ˆ: ê³ ê° ì¹´ë“œ í•œë„ì´ˆê³¼, ê±°ë˜ì •ì§€ì¹´ë“œ, ì”ì•¡ë¶€ì¡± ë“±)
          //paymentResult.status : failed ë¡œ ìˆ˜ì‹ ë¨
          res.send({ ... });
        }
        res.send({ ... });
      } else { // ì¹´ë“œì‚¬ ìš”ì²­ì— ì‹¤íŒ¨ (paymentResult is null)
        res.send({ ... });
      }
    } catch (e) {
      res.status(400).send(e);
    }
  });
```

</Tab>
</Tabs>
